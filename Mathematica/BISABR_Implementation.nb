(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    408990,      10644]
NotebookOptionsPosition[    395737,      10246]
NotebookOutlinePosition[    396329,      10271]
CellTagsIndexPosition[    396257,      10266]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/olivier/Documents/Math/NumericalIntegration.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438084708463805*^9, 3.438084723338635*^9}, 
   3.4380853908756237`*^9, {3.695037776113842*^9, 3.695037778501514*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "\"\</Users/olivier/Documents/Math/BS.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.438084743764517*^9, 3.4380853936989517`*^9, {3.69503778155486*^9, 
   3.695037783262341*^9}, {3.695037854730864*^9, 3.695037856426325*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "\"\</Users/olivier/Documents/Math/SABR.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.4380847512765102`*^9, 3.438085396765018*^9, {3.6950377863807793`*^9, 
   3.695037788301272*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/olivier/Documents/Math/Heston_Definitif5.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380811045644245`*^9, 3.4380811183502607`*^9}, 
   3.438084760604393*^9, 3.438085401474907*^9, {3.695037793864953*^9, 
   3.6950377958243427`*^9}}],

Cell[BoxData[
 RowBox[{"<<", "\"\<MultivariateStatistics`\>\""}]], "Input",
 CellTags->"S6.6.1"],

Cell[BoxData[
 RowBox[{"<<", "\"\<ErrorBarPlots`\>\""}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.438084654820359*^9, 3.438084667410611*^9}}],

Cell[BoxData["\<\"/Users/oliviercroissant\"\>"], "Output",
 CellChangeTimes->{3.438084673418634*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Fonctions", " ", "utiles"}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Performs", " ", "the", " ", 
   RowBox[{"integral", " ", ":", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "x"], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], 
         SuperscriptBox["s", "2"]}], "-", 
        FractionBox[
         SuperscriptBox["b", "2"], 
         SuperscriptBox["s", "2"]]}]], 
      RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "=", 
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a", ",", "b", ",", "x"}], "]"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SqrtBox["\[Pi]"], 
            RowBox[{" ", 
             RowBox[{"4", "a"}]}]], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", " ", "2"}], "a", "  ", "b"}]], "  ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"4", "  ", "a", " ", "b"}]], "+", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", "  ", "a", " ", "b"}]], " ", 
                RowBox[{"Erf", "[", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], "]"}]}], "-", 
               RowBox[{"Erf", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{" ", "b"}], 
                  RowBox[{" ", "x"}]], "-", 
                 RowBox[{"a", " ", "x"}]}], "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "b"}], " ", 
              SqrtBox["\[Pi]"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]}]], " ", "x"}], "+", 
             RowBox[{"b", " ", 
              SqrtBox["\[Pi]"], " ", 
              RowBox[{"Erf", "[", 
               FractionBox["b", "x"], "]"}]}]}], ")"}], "+", 
           RowBox[{
            FractionBox["1", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox["b", "2"], 
                   SuperscriptBox["x", "2"]]}]]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["b", "3"], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   FractionBox[
                    SuperscriptBox["b", "2"], 
                    SuperscriptBox["x", "2"]]], " ", 
                  SqrtBox["\[Pi]"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", "x"}], "+", 
                 SuperscriptBox["x", "3"]}], ")"}]}], "+", 
              RowBox[{"2", 
               SuperscriptBox["b", "3"], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{
            FractionBox["1", "30"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "4"], " ", "x"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["b", "2"], " ", 
               SuperscriptBox["x", "3"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["x", "5"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "4"]}]}], ")"}]}]}], "\[IndentingNewLine]", 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "If", " ", "we", " ", "use", " ", "the", " ", "No", " ", "function", " ", 
   "defined", " ", "by", "  ", 
   RowBox[{"No", "[", "x", "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Erf", "[", 
     FractionBox["x", 
      SqrtBox["2"]], "]"}]}], "+", 
   FractionBox["1", "2"]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"the", " ", "ATM", " ", "is", " ", "caracterized", " ", 
   RowBox[{"by", " ", ":", " ", "b1"}]}], "=", "0"}]], "Input"],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "GIntegralAnalytical", "  ", 
  "using", " ", "NormalCDF", " ", "function"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical1", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a", " ", "b"}]], " ", 
           SqrtBox["\[Pi]"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a", " ", "b"}]], "-", 
             RowBox[{"NormalCDF", "[", 
              RowBox[{
               SqrtBox["2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["b", "x"], "-", 
                 RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "a", " ", "b"}]], " ", 
              RowBox[{"NormalCDF", "[", 
               RowBox[{
                SqrtBox["2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}]}]}], ")"}], " "}], 
          RowBox[{"2", " ", "a"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"Sign", "[", "x1", "]"}], "30"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", "x", " ", 
            RowBox[{"(", 
             RowBox[{"30", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"]}], "-", 
                 SuperscriptBox["x", "2"]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["a", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["b", "4"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", 
                  SuperscriptBox["x", "2"]}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["x", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"(", 
             RowBox[{"15", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox["b", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["a", "4"], " ", 
               SuperscriptBox["b", "4"]}]}], ")"}], " ", 
            SqrtBox["\[Pi]"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"NormalCDF", "[", 
               FractionBox[
                RowBox[{
                 SqrtBox["2"], " ", "b"}], "x"], "]"}]}], ")"}]}]}], 
          ")"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Computes", "  ", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "A", "B"], 
   RowBox[{
    FractionBox[
     SuperscriptBox["r", "\[Gamma]"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["r", 
        RowBox[{"2", " "}]], "-", " ", 
       RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
    RowBox[{"\[DifferentialD]", "r"}]}]}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<A=\>\"", ",", "A", ",", "\"\< B=\>\"", ",", "B", ",", 
       "\"\< G=\>\"", ",", "G", ",", "\"\< F=\>\"", ",", "F", ",", 
       "\"\< \[Gamma]=\>\"", ",", "\[Gamma]", ",", "\"\< roots=\>\"", ",", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["r", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"r", " ", "G"}], " ", "+", "F"}], "\[Equal]", "0"}], ",", 
         "r"}], "]"}], ",", "\[IndentingNewLine]", "\"\< X1=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\< X2=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SqrtBox["F"], "  ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Gamma]"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["A", 
           RowBox[{"1", "+", "\[Gamma]"}]]}], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["B", 
          RowBox[{"1", "+", "\[Gamma]"}]], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], "}"}], ",", 
    RowBox[{"BiSABRIntegralN", "[", 
     RowBox[{
     "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", "legendrelst"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegralN", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_", ",", 
    "legendrelst_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoeffBasedIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["#", "\[Gamma]"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["#", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"#", "G"}], " ", "+", "F"}]]], ")"}], "&"}], ",", 
      RowBox[{"LegendreCoeffsFromLegendre", "[", 
       RowBox[{"legendrelst", ",", "A", ",", "B"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "1.2"}], ",", 
     RowBox[{"B", "=", "3.5"}], ",", 
     RowBox[{"F", "=", "3.4"}], ",", 
     RowBox[{"G", "=", "0.9"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.54"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3668051250803241`", ",", "1.3668051250803241`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.695038352903995*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\"\<A=\>\"", "\[InvisibleSpace]", "0.1445206290517883`", 
  "\[InvisibleSpace]", "\"\< B=\>\"", "\[InvisibleSpace]", 
  "0.14883523895735173`", "\[InvisibleSpace]", "\"\< G=\>\"", 
  "\[InvisibleSpace]", "0.24226344208464132`", "\[InvisibleSpace]", 
  "\"\< F=\>\"", "\[InvisibleSpace]", "0.022926396629179044`", 
  "\[InvisibleSpace]", "\"\< \[Gamma]=\>\"", "\[InvisibleSpace]", 
  "0.6666666666666667`", "\[InvisibleSpace]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Computation", " ", 
  RowBox[{"of", " ", ":"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.012714488324704634`", ",", "0.012714488324704634`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6950383657224894`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "A", ",", "B"}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
-31.8768 220.734 -80.9721 27.5877 [
[.35036 .1233 -15 -9 ]
[.35036 .1233 15 0 ]
[.57109 .1233 -15 -9 ]
[.57109 .1233 15 0 ]
[.79182 .1233 -15 -9 ]
[.79182 .1233 15 0 ]
[.11712 .27374 -30 -4.5 ]
[.11712 .27374 0 4.5 ]
[.11712 .41168 -24 -4.5 ]
[.11712 .41168 0 4.5 ]
[.11712 .54962 -30 -4.5 ]
[.11712 .54962 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.35036 .1358 m
.35036 .14205 L
s
[(0.146)] .35036 .1233 0 1 Mshowa
.57109 .1358 m
.57109 .14205 L
s
[(0.147)] .57109 .1233 0 1 Mshowa
.79182 .1358 m
.79182 .14205 L
s
[(0.148)] .79182 .1233 0 1 Mshowa
.125 Mabswid
.17377 .1358 m
.17377 .13955 L
s
.21792 .1358 m
.21792 .13955 L
s
.26206 .1358 m
.26206 .13955 L
s
.30621 .1358 m
.30621 .13955 L
s
.3945 .1358 m
.3945 .13955 L
s
.43865 .1358 m
.43865 .13955 L
s
.4828 .1358 m
.4828 .13955 L
s
.52694 .1358 m
.52694 .13955 L
s
.61524 .1358 m
.61524 .13955 L
s
.65938 .1358 m
.65938 .13955 L
s
.70353 .1358 m
.70353 .13955 L
s
.74768 .1358 m
.74768 .13955 L
s
.08548 .1358 m
.08548 .13955 L
s
.04133 .1358 m
.04133 .13955 L
s
.83597 .1358 m
.83597 .13955 L
s
.88012 .1358 m
.88012 .13955 L
s
.92427 .1358 m
.92427 .13955 L
s
.96841 .1358 m
.96841 .13955 L
s
.25 Mabswid
0 .1358 m
1 .1358 L
s
.12962 .27374 m
.13587 .27374 L
s
[(2.945)] .11712 .27374 1 0 Mshowa
.12962 .41168 m
.13587 .41168 L
s
[(2.95)] .11712 .41168 1 0 Mshowa
.12962 .54962 m
.13587 .54962 L
s
[(2.955)] .11712 .54962 1 0 Mshowa
.125 Mabswid
.12962 .02545 m
.13337 .02545 L
s
.12962 .05304 m
.13337 .05304 L
s
.12962 .08063 m
.13337 .08063 L
s
.12962 .10822 m
.13337 .10822 L
s
.12962 .16339 m
.13337 .16339 L
s
.12962 .19098 m
.13337 .19098 L
s
.12962 .21857 m
.13337 .21857 L
s
.12962 .24615 m
.13337 .24615 L
s
.12962 .30133 m
.13337 .30133 L
s
.12962 .32892 m
.13337 .32892 L
s
.12962 .35651 m
.13337 .35651 L
s
.12962 .38409 m
.13337 .38409 L
s
.12962 .43927 m
.13337 .43927 L
s
.12962 .46686 m
.13337 .46686 L
s
.12962 .49444 m
.13337 .49444 L
s
.12962 .52203 m
.13337 .52203 L
s
.12962 .57721 m
.13337 .57721 L
s
.12962 .60479 m
.13337 .60479 L
s
.25 Mabswid
.12962 0 m
.12962 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .01472 m
.06244 .04227 L
.10458 .07197 L
.14415 .09951 L
.18221 .12569 L
.22272 .15323 L
.26171 .1794 L
.30316 .20688 L
.34309 .23301 L
.3815 .25783 L
.42237 .2839 L
.46172 .30868 L
.49955 .33219 L
.53984 .35691 L
.57861 .38038 L
.61984 .405 L
.65954 .42838 L
.69774 .45056 L
.73838 .47384 L
.77751 .49594 L
.81909 .51907 L
.85916 .54103 L
.89771 .56186 L
.93871 .58367 L
.97619 .60332 L
s
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzVmntsVEUYxW+7LZRasLFifYDd0pYqguCDoBI01gC+kKASDdpIAbGghIbW
EEIIUSIGNUQMIb5AiRp8KyGihqgh+AhR06hBA/EVjUYN+rf4T92dezl3evec
b181wU26O3vmN2dmvjv3fnfudk5XX/edK7r6li3uSs9e1dXTvWxxb3rWylUZ
KVURBBXpIAh2p4NseSBTjN7aBjKvIJX9MhC9gr/dezDkVcNJ1Vkar8l+VGZr
DKiWVJ2u8ZNIVSP6ORZCdRAatdMoUnWqxk8mVQ0ar8cQDOgUUlWv8QZ4GtBo
UjVS46fBc2QyiuwosKMVOZ2B9gbEFgJbVRE+Bp4GdDapqtJ4EzwNqNl9VPtV
YX3m9U9YGEda++FryX646qhBvnPOb9wWzeI4G53u5w8euyulsqVqlJx/WH28
VfavrcCWKTLI1gLbVqJ2ij8LHsWJiRlGOls7VRytJGhzsa7J45ertfwnA53k
R4gMwoVxgtV1VTKsLs6ZaEeU38KeBHdiK6EEGzGgyXr+7MC0Wx3zBcai7r61
DpVXrjauVOuc2OWcRk4YRvocb/VpL++glMOc35JNKV/cS3Y1FtIwxK0dpVqU
qlGKr2CtJudGUDX4air9cq+DgwdXQ7Q/NT6CaEc1Hg/LgOqI9rvG4xuECHLx
T2ffKkKBGbKBs0NeziW6UL9Cx1LOmE/0toVy4foc8kOaOJtOkMn+H9sWeSDZ
Ge22O+5g/KSheIfwo4bYXuE7jcd7BQNie4UjHu7ajyXQYe05Fg0NqIloX2s8
TbRDGm/GEAyohWhfajzOWwY0nmj9yXieg1K/djqXaJ9pfAI8DWgi0Q5qfBI8
DWgy0T7W+BR4GtCFRDuQjOLFKB3QTlMB7dfQNKK9r/FL4GlAlxFtn8anw9OA
ZhDtHY1fDk8fcsKVKO3V7TuItkfjV8HTgGYS7U2Nz4KnAV1NtNdC3N3cuLvJ
+H4xvhOtRineDrK7/2tQ69smIPbQrIi9KtsiXEe0l0OPalI1YvB03FaIjTQO
wPWYWGTLZj/cmkSOHMeZed1AtF1+THP8aoxuCthlsTjNxRB3ecGMdxopBI6t
l4TZPKI9H9qytXojbA3oZqLt1Ph8eBrQLYCe8SAnLCD409ppARoa0O1Ee0Lj
nfA0oDuItk3jC+FpQIsAbdXQEqJtSUZxKUpbtNNdRNus8W54GtByoj2s8bvh
aUArAG3S0EqibdR4Dzx9yAm9BN+gnXrR0IDuBXSfhlYDWq+hNYDWaWgtoLUa
WgdojYbWA1qdjNP9BO/TTgzv1fgG9GNADxCtR+MbiRaum/BaK3NzfP1leeRB
1PpmNCOX97BxE9HuCU1Ywo9TMMsV8ewewvgjM/YIQCReO8M+gtrlfmRKzath
BHO1zeim24tGIofamfNRtFgaWrD18xigJRraCmiRhrYBWqihx4nW6eGu/ZMo
dWqnpwDdpqHtRLtV4zvgaUDPEm2+xnfC04CeA3SThl4ANC8ZsRdRmqvbvwRo
joZeIdq1Gn8Vngb0OtFma/wNeBrQbkAzNbSHaB3J2L2FUod22ku0KzT+NjwN
6F1AMzS0D9B0Db0H6FINfQBomob2A5qajNOHKF2k238E6AINfQLI+N3jICDj
V8ZPAZ2noc8BhY988mxa48Rop8h+1LZ7tkWnyJI3r1+g/3DSebasMl/KHPoV
Oggf5BWzeY0DawfxEGqb/SCWk00LzbDfoOsmL34yw9q59jDRxoS2bEkeQVcG
9C2gMzX0PdEaNf4DPH0ofnruSqN1+58BNWjoF6LVa/xXeBrQb4BGaegPQHUa
OgqoVkN/AfJ/eXDCMd2qrP9LCyr+BYCtbgo=\
\>"],ImageRangeCache->{{{0., 287.}, {176.938, 0.}} -> {0.144407, 2.93508, \
1.58243, 0.000126613}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "  ", ";", 
   RowBox[{"b1", "=", 
    RowBox[{
     SuperscriptBox["C", "\[Prime]",
      MultilineFunction->None], "[", "f", "]"}]}], ";", 
   RowBox[{"b2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["C", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "f", "]"}], 
      RowBox[{"C", "[", "f", "]"}]}], "+", 
     SuperscriptBox["b1", "2"]}]}], ";", 
   RowBox[{"B0B\[Alpha]z", "=", 
    RowBox[{
     RowBox[{"C", "[", "K", "]"}], 
     RowBox[{"C", "[", "f", "]"}]}]}]}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData["with"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"C", "[", "f", "]"}], "=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], 
   "  ", "computes", "  ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "A", "B"], 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
     RowBox[{"\[DifferentialD]", "r"}]}]}]}], " ", ";", "  ", 
  RowBox[{"so", " ", "..."}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"]}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", "legendrelst_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegralN", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"], ",", "legendrelst"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"BiSABRz", "[", 
    RowBox[{
    "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
     "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"5.592368775172879`", "\[VeryThinSpace]", "-", 
  RowBox[{"2.0603526551973057`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.695038381433955*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Csabr", "[", 
   RowBox[{
   "f_", ",", "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "F2_", ",", 
    "\[Alpha]2_", ",", "\[Beta]2_", ",", "\[Rho]s_"}], "]"}], ":=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "f"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Csabr", "[", 
        RowBox[{
        "fx", ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "F2", ",", 
         "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]s"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"fx", ",", 
        RowBox[{"K", "-", "0.01"}], ",", "f"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVk3k0FHwfxWWNsUxjMGYm0Zv1sZSEPPj+KpQlWpQiS5R9n7GNLdlKUYSG
wkz1IluPkBb1S0mUslRSSSoS9YwpO03e3j/uueee8zn3j3vOVfMO23NUWEhI
6N4f/d/Pii4avu1JxN2XqMXN5UTEa17I29iViLO0w2/z3xFRz63ZPfUlifjF
8YyGhbZV6PqdKZJBWCIO/11gWeZFQvl3+X01KBHHN+5k7BgloWj8b54OKREP
kG4NbXeXRwdaJ/ZUfk7APNvyt++75JHZwzGSRlMCDt3BdrIyJqPl9o95agcS
cOdXY7O9S2Q0LNSbdkM9AWuLH5kneymg+2b3o+2n4vHapldOtq0K6HhdqWtU
Tjwe6tRN2MlSRD5fsx2kDsVjuZZs99Q+RWS1NtGyTDsedxPl9MS0lJB4odva
zjYWbihzeaX9VAmNdduRPfJYePuDpZo3FArqkDQTn/Jk4aYZz/qfPhSUlUiZ
oC/F4bpG/377nxQU1CwxWN8RhxlfDcUTNikjhx+zz2wK4zCHtq97NkoZyR59
VR++IQ6fy6KTODxlNFnadllsORa/EXkueVODinoGGgqKu2Lx3z3FDjw3Kqon
Xc40KI7Fn6yvV5nmUFGeQ15cm18sdnrgPZx9l4oYGSlBBzfFYkuTL89Hx6nI
+X64O084Fg8kO9Rulqcho0VPp9SeGPzGZHRD2mYaUjBy2kIpjcFtjhGNrYdo
aDbEcmNtUAzWobvY8hNoqL9CT33r5hgcZCHXL1dMQ80f6UqvxWNwZLHwmrWN
NMSmSUsGv4zG665QunWe0lDcvqVFoUvROI9tGWfwgYZcz0x8LwiLxiMi5vkm
fBr6u/PNkI5FNI68ZhTh8JuG6CKdPVgqGqf3bdOLk6QjgfnNB84DUfjQh/LS
J6voaCi6onH8v1F4QW3OwkmJjvA/heVJjCjcrjFPUKLSEWcinS2/JQoXo3Tm
xj85ZV1UVqVsFJ730TFo/sN7exxJsBhk4tYvU6tvkOhoK3tvaN9VJo68KNCx
JtDRf/q2evnFMHEAw0qdtYKORKUN9/yyYuJ6b+OSoBkaGrFWs8olMbFcFKN1
/RgNPUomGmsMM3C7h5b5x34aKr+1rHmnloEJ1zxXFbTRUOYUT3lXPAMbXi1O
OvIPDfnrDRFGdzDw4aTZd35/9tPhtkzKjkTig5t+lwUF0BDhXfXHy/WRONVH
CF10pKHv5AsvTJMjsdRwL+mwIQ3VnYhr9qZG4uO6Z9VEZ6loQ7hx8o1dEZjC
n2qgh1MRqUo9wl4lAu/3J2zzcKCiqc9kn+Fv4TjNwqtzSJOKmlymbKQyw7Ek
p2vn6KAyikjyWt3CCsNhq3if3yBlJIXCCs7Rw7Dy24DIXJoyurIiSSboXige
j0wJlJmloIG0CwJl4VDcK3b+FKuKgtCp/vcxJ4OxqiFHbx2JguTYDqUb2QG4
5T2NsPxJEVUedFMkmAXgin97H9TcVURbaYE5n9754xxZyWMn2YooujQzKXeN
P95s/Kb+vaMiGrrywGOy3BfvqFJt2XJPAdXWm66pbvLBdus7TrddJSMbxvbz
x118sGOnr1jKiT//Ntov57rgjXNaJJSy/MiIfJOxvNLCG4v6to6napBRwr26
D75tXtgvRJeiUimPCgttkXW5GzYT+GSO3yKh/57blub/wAnfXfg+pqmwCpVd
fcvU2u2IAyZl58sERFSEI45+/eCA28+X5Oz/QkTZ38ps/AW2OOTM0NmEm0QU
te3XSn9TK5w58foq25OIsr4E0LoPbcD5jzxt+eFy6Ne69Qsl07pYQuidrYyt
HBpJOH2nxEATd/+d0JSrJof8DmYdM7NXws3d7lefvpBFrmN5wY8HFcENB1QO
m8siE9eGXsOn5qD9l29dkqoMstJP51+vBeBcrD2b9FsaaaVUZyrv2ALCXm64
b1AaGe1LLC/SsYL7vWP1jGJp5CBQHSmatIXnD94ls5Sl0T2NRoNnLXtAUZp9
+446AfGil6qe2XjAhHt+9O1wSTRLGJsgynmC5Vadp3b7JJGA06fj/NoTLuv7
Sa02k0QZo877/m3wgi2+th2popKoUE73FcPKG75rtqZsvbgSNfq8fXns6FG4
Jlrb39svgUz1e5iXOo+CtszZeypYArXMPyK36flCZ4WhDLdCAj3MrneWmPWF
uZfxmtviJFBf84mX2Rn+EFKjMjKhIoH4BJOXxRVBEMsOirNgiCNmvy6zhRAM
vMs/avI9xNE8Zy15KCwYbGZ5OUp24mh5k6yzmmkIEFc+QaVq4kjWa/RFRUco
LAnOLXP6xJDi286At9PhEGp/0E3OXAxt0o8NGFNggi83wzZDWxRlfXcN41ox
4Uod2SOFKoqGqyyi3BhM6Lvef62QIIpOa4qkdPcwIaXu1rwsTwSNqOawm09F
Qcz34D79RhGUJ3/lceaKGDhvaSY6bSWC+PPd6lr/xgEhd5WQUIwwsmm+/tcn
Ggtul1+CZ4HC6GJUwYaLdixgaOVU1HoIox0/XS2IlSwwgJ1mFTbCqOzbqPO8
dzyIdBHPxCoJI8ehpdSOgQQoakt/EtqyAtU81Pzk35YMhD2TzkWkFUjEjnKD
MJcMFZcDfl6RWIH0/EWtX5OPwdyWgIjWX0IojTdNYW0/Bt96jaN0x4SQ4dKr
+7jmGCy9inJpbxFCOWQ20T4mBVjrxFTHA4WQzXb6P4elUyGoXfHJ4uVliMwi
UxvUU8HSpFamNXcZSp5Jp4lCKog3H27lJC/D9F6BS0VEKpSYLpRWuy3DJa+h
5e/9qRAuHOA+Tl6G33Ecp1huGmi8b1gzcOo3NNesm8wxzgD50cgDplkCmNBX
Mg10ygBpIk9LIV4A9HrJFGv/DBhgzY6JBgvgWBOP9KsoAz5w/cvojgKwu3fT
OECQAS7RXiu15QUw2O2QtK0tE2o9duWc5/wC4SmmzPzuk1BSojUy8XgJjKL8
9r8IPAkyjd6rRm8vgd/cwbK61JNwVn/WjFe7BF1LlhuONp2EnX+vp+jlL0GB
qOS+PkoWxO4Xp7seXgItxZKLNR+ygO32kOr2exF2bn701+GQ0/DWfY3R3q2L
IFVZLZebdhpig1cIsMkitCvmTd2/cBo+Sr/ebqK3CJbTHndUn5wGhvmhtdaU
RVh/bd5uWCMbhoPV/hrkLQBJXTfQczgbKus+zI+XLMAA8Vyl+94zsOIO20hF
ZAE2MP8h1dJzwdG9+rrc2BycXa1pCtq5wLa6Mb34fg547SXuvZtyQd/hWifv
5RxUKZ+qnHHMhRPoycLkgzlYh49aWqbkQo9ek4JL2RxQpGiB3aO50GtdeaX2
4BwIcdJbf9TlQdOGV/K6L2fh+VPXcOMt+ZBeGji0fmgGIoPsP/90yIc9zypC
fF/PgALBfP+1A/mww420jdszA4fsVptrhefDbremco2HMzDR8UGCWpYP5auC
ysIqZ0Cs/UiZ4NefPmnViWnGDJjfD33edrMASpXOp16WnYHqxuO6e9efh21h
z6e8d0+DT9LPx9XEYlgqMjE7KTUFeh2WVrkGJaCrbVKj+v4HXNidJpcuzQHF
jMbCXxN8GPR84ysmz4GAugsZ0mN8UAnVv5euzAFf/8lOlc98uJQ1EJyhwYHe
Bq2tdu/4UPlQ90km4kDRlryWlqd8aNz0Ki2LyQGJZ2XLMrV86FLWWDwzyIGf
TFfW3gg+yGrF7yZ+5kDksTd9V0P44GTcU3l2nANnkKqlcCAf+vawXHJnOZAm
nm99y5sPA6eeN+YRuVBfnTgCznwYEUSHFVhx4fnX7121JnzQkO5qV7Dngnnr
zph1Rnzwo6qpFO7mwoGRBqWS9XyYMH7aVejBhdaMqo352nzgh63RYcdygfcj
pLKIxgfDJGYKJZkLajpKL9ZQ+MA43TnATueCT5/BlwoyH2YrGZlFeVxY+0gK
35Xhg2lzx5ByERc0ypNT7KX4wHq02ri4jAteKp3q78T50PIiMptazoVdB62r
gkX4IPj4eKS4hgsnwp1lhIT48D8VA5fk
       "]]},
     Annotation[#, "Charting`Private`Tag$579#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 1.0000000496575314`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-0.11, 0.034519999999999995`}, {1.0000000496575314`, 
   7.025586910851553}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.695038403621064*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Definition", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"l", "=", "0"}], "\[Infinity]"], 
     FractionBox[
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"a", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "1"], ",", "k"}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "2"], ",", "l"}], "]"}], " ", 
       SubsuperscriptBox["z", "1", "k"], " ", 
       SubsuperscriptBox["z", "2", "l"]}], 
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"c", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"k", "!"}], " ", 
       RowBox[{"l", "!"}]}]]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]]],

Cell[BoxData[
 RowBox[{"low", " ", "order", " ", "development"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["z", "1"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "2"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "1"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubscriptBox["z", "1"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"4", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "c"}], ")"}]}]], "+", "\[Ellipsis]"}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]]],

Cell[BoxData[
 RowBox[{"general", " ", "development"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{"Gamma", "[", "c", "]"}], 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "2"], "]"}]}]}]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "0"}], "\[Infinity]"], 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"a", "-", "s", "-", "t"}], "]"}], 
          RowBox[{"Gamma", "[", "s", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "1"], "-", "s"}], "]"}], " ", 
          RowBox[{"Gamma", "[", "t", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "2"], "-", "t"}], "]"}]}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "s", "-", "t"}], "]"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "1"]}], ")"}], 
         RowBox[{"-", "s"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "2"]}], ")"}], 
         RowBox[{"-", "t"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{"-", "j"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"-", "k"}]}], "}"}]}], "]"}]}]}]}]}]],
 CellChangeTimes->{{3.6950384842147427`*^9, 3.695038489186213*^9}}],

Cell[BoxData[
 RowBox[{"Integral", " ", "representation"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], " "}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}]}]], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", 
        RowBox[{"a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "t"}], ")"}], 
        RowBox[{"c", "-", "a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "1"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "1"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "2"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "2"]}]]}], 
      RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "\[And]", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"c", "-", "a"}], "]"}], ">", "0"}]}]}]]],

Cell[BoxData[
 RowBox[{"Differential", " ", "equation", " ", "followed"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "1"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "1"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "1"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "2"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       SubscriptBox["z", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "2"], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "2"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "2"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "2"], 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}]}], ")"}], "/;",
   " ", 
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]]],

Cell[BoxData[
 RowBox[{"Integral", " ", "and", " ", "differential"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Integral]", 
   RowBox[{
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      RowBox[{"\[ScriptA]", " ", 
       SubscriptBox["z", "1"]}], ",", 
      SubscriptBox["z", "2"]}], "]"}], 
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["z", 
      RowBox[{" ", "1"}]]}]}]}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "-", "1"}], ")"}], " "}], 
    RowBox[{"\[ScriptA]", 
     RowBox[{"(", 
      RowBox[{"a", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["b", "1"], "-", "1"}], ")"}]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"a", "-", "1"}], ",", 
     RowBox[{
      SubscriptBox["b", "1"], "-", "1"}], ",", 
     SubscriptBox["b", "2"], ",", 
     RowBox[{"c", "-", "1"}], ",", 
     RowBox[{"\[ScriptA]", " ", 
      SubscriptBox["z", "1"]}], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["z", "1"], ",", "n"}], "}"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Pochhammer", "[", 
       RowBox[{"a", ",", "n"}], "]"}], " ", 
      RowBox[{"Pochhammer", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", "n"}], "]"}]}], 
     RowBox[{"Pochhammer", "[", 
      RowBox[{"c", ",", "n"}], "]"}]], " ", 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"a", "+", "n"}], ",", 
      RowBox[{
       SubscriptBox["b", "1"], "+", "n"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"c", "+", "n"}], ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"n", "\[Element]", "Integers"}], "\[And]", 
   RowBox[{"n", ">", "0"}]}]}]]],

Cell[BoxData[
 RowBox[{"Formule", " ", "asymptotiques"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"Gamma", "[", "c", "]"}], 
     RowBox[{"Gamma", "[", "a", "]"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "\[Infinity]"], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"a", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}], 
        RowBox[{"Pochhammer", "[", 
         RowBox[{
          SubscriptBox["b", "2"], ",", "k"}], "]"}]}], 
       RowBox[{
        RowBox[{"k", "!"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"c", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}]}]], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        RowBox[{"1", "-", "c", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        RowBox[{"1", "-", "a", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}], " ", 
      SubsuperscriptBox["z", "2", "k"]}]}]}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"a", "-", 
        SubscriptBox["b", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", 
        SubscriptBox["b", "1"]}], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", 
            SubscriptBox["b", "1"]}], ")"}], "2"], 
         SubscriptBox["b", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c", "-", 
           SubscriptBox["b", "1"]}], ")"}], "2"]], 
       SubscriptBox["z", "2"], 
       RowBox[{"HypergeometricPFQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", 
             RowBox[{
              SubscriptBox["b", "2"], "+", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["b", "1"], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "1"}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", "-", 
             SubscriptBox["b", "1"], "+", "1"}], "}"}]}], "}"}], ",", 
         FractionBox[
          SubscriptBox["z", "2"], 
          SubscriptBox["z", "1"]], ",", 
         SubscriptBox["z", "2"]}], "]"}]}], "+", 
      RowBox[{"HypergeometricPFQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           SubscriptBox["b", "1"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["b", "2"], ",", 
            RowBox[{"a", "-", 
             SubscriptBox["b", "1"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "c", "+", 
             SubscriptBox["b", "1"]}], ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", "-", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", "-", "a", "+", 
            SubscriptBox["b", "1"]}], "}"}]}], "}"}], ",", 
        FractionBox[
         SubscriptBox["z", "2"], 
         SubscriptBox["z", "1"]], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}]}], ")"}]}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Proportional]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{
         SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", "a"}], "]"}], " ", 
       RowBox[{"Gamma", "[", 
        SubscriptBox["b", "1"], "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", "a"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"a", "-", 
         SubscriptBox["b", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", 
         SubscriptBox["b", "1"]}], "]"}], 
       RowBox[{"Gamma", "[", "a", "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", 
       SubscriptBox["b", "1"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}]}]}], "/;", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SubscriptBox["z", "1"], "]"}], "\[Rule]", "\[Infinity]"}], ")"}], 
   "\[And]", 
   RowBox[{"a", "\[NotEqual]", "b"}]}]}]]],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "x_", ",", "y_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "j", ",", "sumtotale", ",", "currentterm", ",", "firstTerm", 
      ",", "amnfirst", ",", "nx", ",", "cmnfirst", ",", "my", ",", "amn", ",",
       "cmn", ",", "b1n", ",", "b2m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentterm", "=", "1"}], ";", 
     RowBox[{"nx", "=", "1"}], ";", 
     RowBox[{"my", "=", "1"}], ";", 
     RowBox[{"b2m", "=", "b2"}], ";", 
     RowBox[{"firstTerm", "=", "1"}], ";", 
     RowBox[{"b1n", "=", "b1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumtotale", "=", "0"}], ";", 
     RowBox[{"amnfirst", "=", "a"}], ";", 
     RowBox[{"cmnfirst", "=", "c"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"currentterm", "=", "firstTerm"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b2m", "=", "b2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"amn", "=", "amnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cmn", "=", "cmnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"my", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sumtotale", "+=", "currentterm"}], ";", 
           RowBox[{"currentterm", "*=", 
            RowBox[{"amn", " ", "b2m", " ", 
             RowBox[{
              RowBox[{"y", "/", "cmn"}], "/", "my"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<i=\>\"", ",", "i", ",", "\"\< j=\>\"", ",", "j", ",", 
               "\"\< currentterm=\>\"", ",", "currentterm", ",", 
               "\"\< sumtotal=\>\"", ",", "sumtotale"}], "]"}], ";"}], 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"amn", "++"}], ";", 
           RowBox[{"b2m", "++"}], ";", 
           RowBox[{"cmn", "++"}], ";", 
           RowBox[{"my", "++"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"firstTerm", "*=", 
         RowBox[{"x", " ", "amnfirst", " ", 
          RowBox[{
           RowBox[{"b1n", "/", "cmnfirst"}], "/", "nx"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amnfirst", "++"}], ";", 
        RowBox[{"cmnfirst", "++"}], ";", 
        RowBox[{"b1n", "++"}], ";", 
        RowBox[{"nx", "++"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "sumtotale"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", "b1", ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version2", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version3", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version4", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", "z1", 
       ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version5", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", "z2", ",", "Nb"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "1.4285714285714"}], ",", 
     RowBox[{"b1", "=", "0.5"}], ",", 
     RowBox[{"b2", "=", "0.5"}], ",", 
     RowBox[{"c", "=", "2.4285714285714"}], ",", 
     RowBox[{"z1", "=", 
      RowBox[{"1.1737504870683", "+", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"z2", "=", 
      RowBox[{"1.1737504870683", "-", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"Nb", "=", "150"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HypergeometricAppellF1Version1", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version2", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version3", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", ",", 
     RowBox[{"HypergeometricAppellF1Version4", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version5", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"8.191250777003514`*^57", "+", 
    RowBox[{"6.96898287454082`*^41", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.5984880191933416`*^72", "+", 
    RowBox[{"1.4386102719719762`*^71", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.618253165535394`*^72", "-", 
    RowBox[{"1.8268625400817602`*^71", " ", "\[ImaginaryI]"}]}], ",", "Null", 
   ",", 
   RowBox[{
    RowBox[{"-", "5.768091527866253`*^63"}], "-", 
    RowBox[{"4.678396843370144`*^64", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.8415401009704138`*^64"}], "-", 
    RowBox[{"1.3862699191173578`*^65", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"HypergeometricAppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", "x", ",", "y", ",", "4"}], "]"}], 
   ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"a", " ", "y", " ", 
    SubscriptBox["b", "2"]}], "c"], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "2"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "3"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"6", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"]}], "c"], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"4", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"36", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "c"}], ")"}]}]]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
HypergeometricAppellF1[1.4285714285714,0.50000000000000,0.50000000000000,2.\
4285714285714,
1.1737504870683+\[ImaginaryI] 0.88031286530120,1.1737504870683-\[ImaginaryI] \\
0.88031286530120,150]\
\>", "Input"],

Cell[BoxData[
 RowBox[{"1.1184639606115216`*^45", "+", 
  RowBox[{"3.1691265005705735`*^30", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["AppellF1[1.1,2.09,3.7,4.12,0.19-0.5 \[ImaginaryI],0.9]", "Input"],

Cell[BoxData[
 RowBox[{"6.616499213883773`", "\[InvisibleSpace]", "-", 
  RowBox[{"5.8714598634635795`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppellF1", "[", 
  RowBox[{
  "1.4285714285714", ",", "0.50000000000000", ",", "0.50000000000000", ",", 
   "2.4285714285714", ",", "\[IndentingNewLine]", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}], ",", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"1.4301741471254665`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{"0.19098042207655", "^", "2"}], "-", 
   RowBox[{"4", " ", "0.014247469381460"}]}]]], "Input"],

Cell[BoxData[
 RowBox[{"0.`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.14323531655741475`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"z1", "=", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";", 
  RowBox[{"z2", "=", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"z2", "-", "z1"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input"],

Cell[BoxData["1.9621461397679203`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", "z2", "]"}]], "Input"],

Cell[BoxData["1.4671881088353598`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"z2", "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input"],

Cell[BoxData["1.6351217831399636`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Power", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z2", "-", "z1"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"z2", "-", "1"}], ")"}]}], ",", "10"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "312.1012926642466`"}], "-", 
  RowBox[{"786.2069686500461`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "We", " ", "extend", " ", "the", " ", "definition", " ", "of", " ", "the", 
   " ", "appell", " ", "function", " ", "to", " ", "x"}], ",", 
  RowBox[{
   RowBox[{
   "y", " ", "couple", " ", "outside", " ", "the", " ", "real", " ", "axis", 
    " ", "x"}], ">", 
   RowBox[{"1", " ", "or", " ", "y"}], ">", "1"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "2"], "-", 
       SubscriptBox["z", "1"]}], 
      RowBox[{
       SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     SubscriptBox["b", "1"], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", "c", ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "1"], "-", 
       SubscriptBox["z", "2"]}], 
      RowBox[{
       SubscriptBox["z", "1"], "-", "1"}]], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", "c", ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "2"], "-", 
        SubscriptBox["z", "1"]}], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "1"], "-", 
        SubscriptBox["z", "2"]}], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "2"]}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"c", "-", "a"}], ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{"Generic", " ", "Algorithm", " ", "For", " ", "Generic", " ", "SABR",
   " "}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"C", "[", "f_", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"f", "+", "A"}], ")"}], "\[Beta]"]}], "        ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "determine", " ", "z"}], ",", "b1", ",", "b2"}], " ",
    "*)"}], " ", "*)"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"C", "[", "f", "]"}], "=", 
    RowBox[{
     RowBox[{"B", "[", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]", " ", "z"}], "]"}], " ", 
     "determines", " ", "B"}]}], ",", " ", 
   RowBox[{"so", " ", ":"}]}], " ", "*)"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}], "  ", "determines", " ", 
       "z"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"b1", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], "=", 
      RowBox[{
       SuperscriptBox["C", "\[Prime]",
        MultilineFunction->None], "[", "f", "]"}]}]}], " ", ",", " ", 
    RowBox[{"b2", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["C", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "f", "]"}], 
        RowBox[{"C", "[", "f", "]"}]}], "+", 
       SuperscriptBox["b1", "2"]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"SqB0B\[Alpha]z", " ", "represente", " ", "bien", " ", "sur", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
      RowBox[{"B", "[", "0", "]"}]}]]}], "  ", "*)"}], "\[IndentingNewLine]", 
  " "}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRgeneric5", "[", 
   RowBox[{
   "intrinsec_", ",", "z_", ",", "b1_", ",", "b2_", ",", "zavg_", ",", 
    "SqB0B\[Alpha]z_", ",", "T_", ",", "\[Mu]_", ",", "\[Alpha]_", ",", 
    "\[Rho]_", ",", "\[Nu]_", ",", "printflag_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x", ",", "I0", ",", "I1", ",", "I2", ",", "\[Kappa]", ",", "f1overf0"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I0", "=", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"zavg", " ", "\[Nu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"zavg", " ", "\[Nu]"}], "-", 
           RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I1", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"zavg", " ", "\[Nu]"}], "-", "\[Rho]"}], "I0"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I2", "=", 
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}], 
       SuperscriptBox["I0", "3"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"12", "  ", "\[Mu]"}], "+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["b1", "2"], " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "+", 
          RowBox[{"2", " ", "b2", " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox["\[Mu]", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["I1", "2"], " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{"2", " ", "I0", " ", "I2", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{
          "6", " ", "b1", " ", "\[Alpha]", " ", "\[Nu]", " ", "\[Rho]"}], "-", 
          RowBox[{
          "16", " ", "z", " ", "\[Mu]", " ", "\[Nu]", " ", "\[Rho]"}]}], 
         ")"}]}], 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"z", "  ", "\[Nu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "  ", "\[Nu]"}], "-", 
             RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1overf0", "=", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Mu]"}], "+", 
           RowBox[{"b1", " ", "\[Alpha]", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"z", "  ", "\[Nu]"}], "-", "\[Rho]"}], 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox["\[Rho]", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}]], " ", 
            RowBox[{"Log", "[", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["z", "2"], "  ", 
               SuperscriptBox["\[Nu]", "2"]}], "-", 
              RowBox[{"2", " ", "z", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
             "]"}]}]}], ")"}]}], 
        RowBox[{"4", "  ", 
         SuperscriptBox["\[Nu]", "2"], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}]]}]]]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<z=\>\"", ",", "z", ",", "\"\< zavg=\>\"", ",", "zavg", ",", 
         "\"\< x=\>\"", ",", "x", ",", "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", 
         ",", "\"\< f1overf0=\>\"", ",", "f1overf0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "+", 
      RowBox[{
       FractionBox["\[Alpha]", "2"], 
       SqrtBox[
        FractionBox["2", "\[Pi]"]], " ", "SqB0B\[Alpha]z", "  ", "f1overf0", 
       " ", 
       SqrtBox["I0"], " ", 
       RowBox[{"GIntegralAnalytical", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{"-", "\[Kappa]"}]], ",", 
         FractionBox["x", 
          SqrtBox["2"]], ",", 
         SqrtBox["T"]}], "]"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Regles", " ", "pour", " ", "la", " ", "transcription", " ", "en", 
  " ", 
  RowBox[{"C", "++"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]1", "\[Rule]", "alpha1"}], ",", 
     RowBox[{"\[Alpha]2", "\[Rule]", "alpha2"}], ",", 
     RowBox[{"\[Beta]1", "\[Rule]", "beta1"}], ",", 
     RowBox[{"\[Beta]2", "\[Rule]", "beta2"}], ",", 
     RowBox[{"\[Rho]1", "\[Rule]", "rho1"}], ",", 
     RowBox[{"\[Rho]2", "\[Rule]", "rho2"}], ",", 
     RowBox[{"\[Nu]1", "\[Rule]", "nu1"}], ",", 
     RowBox[{"\[Nu]2", "\[Rule]", "nu2"}], ",", 
     RowBox[{"\[Rho]s", "\[Rule]", "rhos"}], ",", 
     RowBox[{"\[Rho]v", "\[Rule]", "rhov"}], ",", 
     RowBox[{"\[Rho]c12", "\[Rule]", "rhoc12"}], ",", 
     RowBox[{"\[Rho]c21", "\[Rule]", "rhoc21"}], ",", 
     RowBox[{"\[Alpha]s", "\[Rule]", "alphas"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleszz1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleszz2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "2"], "\[Rule]", "alpha1SQ"}],
      ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "2"], "\[Rule]", "alpha2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]1", "2"], "\[Rule]", "beta1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]2", "2"], "\[Rule]", "beta2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]1", "2"], "\[Rule]", "rho1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]2", "2"], "\[Rule]", "rho2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]1", "2"], "\[Rule]", "nu1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]2", "2"], "\[Rule]", "nu2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]s", "2"], "\[Rule]", "rhosSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]v", "2"], "\[Rule]", "rhovSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c12", "2"], "\[Rule]", "rhoc12SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c21", "2"], "\[Rule]", "rhoc21SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]s", "2"], "\[Rule]", "alphasSQ"}], ",", 
     RowBox[{
      SuperscriptBox["X1", "2"], "\[Rule]", "X1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["X2", "2"], "\[Rule]", "X2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F1", "2"], "\[Rule]", "F1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F2", "2"], "\[Rule]", "F2SQ"}]}], "}"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CTranform", "[", "x_", "]"}], ":=", 
  RowBox[{"CForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", " ", "/.", "ruleszz1"}], " ", "/.", " ", "ruleszz2"}], " ", 
    "/.", "rulesz"}], "  ", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{"2", " ", 
   SuperscriptBox["X1", 
    RowBox[{"3", " "}]], " ", "X2", " ", 
   SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["X1", "F1"], ")"}], "2"], " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", 
      SuperscriptBox["\[Beta]1", "2"]}], "+", 
     RowBox[{
      FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]s"}]}], ")"}]}], "+", 
     RowBox[{"\[Nu]1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Nu]1", "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]c21"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}], 
  "]"}]], "Input"],

Cell["\<\
2*Power(alpha1,3)*alpha2*rhos*Power(X1,3)*X2*
   ((alpha1SQ*beta1SQ*X1SQ)/Power(F1,2) + nu1*(nu1 + nu2*rhov + \
(alpha2*beta2*rhoc21*X2)/F2) + 
     (alpha1*beta1*X1*(2*nu1*rho1 + nu2*rhoc12 + \
(alpha2*beta2*rhos*X2)/F2))/F1)\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Precalcul", " ", "pour", " ", "le", " ", "spreadoption"}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         SuperscriptBox["\[Nu]1", "2"], "+", 
         RowBox[{"2", " ", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          "\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       SuperscriptBox["X2", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]2", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         SuperscriptBox["\[Nu]2", "2"], "+", 
         RowBox[{"2", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          "\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], "  ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{"2", " ", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", 
          SuperscriptBox["\[Rho]s", "2"], " ", "\[Rho]v"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{"2", " ", "X1", "  ", 
       SuperscriptBox["X2", 
        RowBox[{"3", " "}]], " ", "\[Alpha]1", " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", "\[Rho]s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"2", " ", "\[Beta]2"}]}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["F2", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}]], " ", "\[Alpha]2", " ", 
           "\[Beta]2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "F1", " ", "\[Nu]2", " ", "\[Rho]2"}], "+", 
             RowBox[{"F1", " ", "\[Nu]1", " ", "\[Rho]c21"}], "+", 
             RowBox[{
              SuperscriptBox["F1", "\[Beta]1"], " ", "\[Alpha]1", " ", 
              "\[Beta]1", " ", "\[Rho]s"}]}], ")"}]}], "F1"], "+", 
         RowBox[{"\[Nu]2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]2", "+", 
            RowBox[{
             FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
             "\[Rho]c12"}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term5", "=", 
      RowBox[{"2", " ", 
       SuperscriptBox["X1", 
        RowBox[{"3", " "}]], " ", "X2", " ", 
       SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         RowBox[{
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"\[Nu]1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]1", "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]c21"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
       "term1", "+", "term2", "+", "term3", "-", "term4", "-", "term5"}]], 
      SuperscriptBox["\[Alpha]s", "2"]]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "\[Nu]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["X1", "3"], " ", 
        SuperscriptBox["\[Alpha]1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], "F1"], "+", 
          RowBox[{"\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X2", "3"], " ", 
        SuperscriptBox["\[Alpha]2", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], "F2"], "+", 
          RowBox[{"\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X1", "2"], " ", "X2", " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], 
              "F1"], "+", 
             RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
             FractionBox[
              RowBox[{
              "X2", " ", "\[Alpha]2", " ", "\[Beta]2", " ", "\[Rho]s"}], 
              "F2"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c21", "+", 
             RowBox[{"\[Rho]1", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], 
              "F2"], "+", 
             RowBox[{"\[Nu]1", " ", "\[Rho]c21"}], "+", 
             FractionBox[
              RowBox[{
              "X1", " ", "\[Alpha]1", " ", "\[Beta]1", " ", "\[Rho]s"}], 
              "F1"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]2", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c12", "+", 
             RowBox[{"\[Rho]2", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Nu]s", " ", 
       SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Nu]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.2504035206821828`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Rho]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas", ",", "nus"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", "1.0279990989437193`"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{
   SuperscriptBox["X1", 
    RowBox[{"2", " "}]], " ", 
   SuperscriptBox["X2", "2"], " ", "F2", "  ", 
   SuperscriptBox["\[Alpha]1", "2"], " ", 
   SuperscriptBox["\[Alpha]2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "2"], " ", "F2", " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "\[Beta]1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
         SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", "\[Rho]2", 
         " ", "\[Rho]s"}], "+", 
        RowBox[{"F2", " ", "\[Beta]1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
           RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
      "-", 
     RowBox[{
      SuperscriptBox["F1", "2"], " ", "F2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]1", "2"], "+", 
        SuperscriptBox["\[Nu]2", "2"], "-", 
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
       ")"}]}]}], ")"}]}], "]"}]], "Input"],

Cell["\<\
alpha1SQ*alpha2SQ*F2*X1SQ*(-(F1SQ*F2*(-1 + rhosSQ)*(nu1SQ + nu2SQ - \
2*nu1*nu2*rhov)) + 
     2*alpha1*F1*(-(beta2*F1*nu2*rho2*rhos) + beta1*F2*(nu2*rhoc12*(-1 + \
rhosSQ) + nu1*rho1*(2 + rhosSQ)))*X1 + 
     alpha1SQ*beta1*F2*(-1 + 2*beta1 + (-2 + beta1)*rhosSQ)*X1SQ)*X2SQ\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3", ",", "term4"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"6", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Beta]2"}], 
       "+", 
       RowBox[{
        SuperscriptBox["X1", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "5"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["X1", 
         RowBox[{"4", " "}]], " ", "X2", " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "4"], " ", "\[Alpha]2", " ", "\[Beta]1", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], ")"}], 
        " ", "\[Rho]s"}], "+", 
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "5"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2"}], "-", 
          RowBox[{"3", " ", "X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Rho]s"}]}],
          ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", "4"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "4"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2", " ", 
           "\[Rho]s"}], "+", 
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "\[Beta]2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Beta]2"}], ")"}], " ", 
              SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}]}], ")"}]}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "3"], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Rho]s", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["F2", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
             "\[Beta]1"}], "-", 
            RowBox[{
             SuperscriptBox["F1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", 
             "\[Beta]2"}], "+", 
            RowBox[{
            "2", " ", "F1", " ", "F2", " ", "\[Beta]1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "F1", " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F2"}], " ", "\[Beta]1", " ", "\[Nu]1", " ", 
             "\[Rho]1", " ", "\[Rho]s"}], "+", 
            RowBox[{"F1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "2"], " ", "F2", "  ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", "2"], " ", "F2", " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
             SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", 
             "\[Rho]2", " ", "\[Rho]s"}], "+", 
            RowBox[{"F2", " ", "\[Beta]1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["F1", "2"], " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Nu]1", "2"], "+", 
            SuperscriptBox["\[Nu]2", "2"], "-", 
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"term1", "+", "term2", "+", "term3", "+", "term4"}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"], 
     ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "F2", ",", "2"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["2", "\[Beta]1"]}], " ", 
     SuperscriptBox["F2", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
     RowBox[{"(", 
      RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["2", "\[Beta]1"], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
       RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["4", "\[Beta]1"], " ", 
        SuperscriptBox["F2", 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", "2"], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "+", "\[Beta]1"}]], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
       "\[Beta]1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["8", "\[Beta]1"], " ", 
          SuperscriptBox["F2", 
           RowBox[{"3", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["4", "\[Beta]1"], " ", 
          SuperscriptBox["F2", 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
         "-", 
         RowBox[{
          SuperscriptBox["X2", "3"], " ", 
          SuperscriptBox["\[Alpha]2", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
         "+", 
         RowBox[{
          SuperscriptBox["2", "\[Beta]1"], " ", 
          SuperscriptBox["F2", "\[Beta]1"], " ", 
          SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Beta]1", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["4", "\[Beta]1"], " ", 
        SuperscriptBox["F2", 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", "2"], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "+", "\[Beta]1"}]], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", "\[Alpha]s", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["4", "\[Beta]1"], " ", 
       SuperscriptBox["F2", 
        RowBox[{"2", " ", "\[Beta]1"}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["X2", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadC", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"s", "+", "F2"}], "]"}], "<", 
       RowBox[{"2", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}], "F2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["2", "\[Beta]1"]}], " ", 
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
          RowBox[{"(", 
           RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["2", "\[Beta]1"], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
            RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["4", "\[Beta]1"], " ", 
             SuperscriptBox["F2", 
              RowBox[{"2", " ", "\[Beta]1"}]], " ", 
             SuperscriptBox["\[Alpha]1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["X2", "2"], " ", 
             SuperscriptBox["\[Alpha]2", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"1", "+", "\[Beta]1"}]], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
             " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
            "\[Beta]1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["8", "\[Beta]1"], " ", 
               SuperscriptBox["F2", 
                RowBox[{"3", " ", "\[Beta]1"}]], " ", 
               SuperscriptBox["\[Alpha]1", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["4", "\[Beta]1"], " ", 
               SuperscriptBox["F2", 
                RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
               SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
               "\[Rho]s"}], "-", 
              RowBox[{
               SuperscriptBox["X2", "3"], " ", 
               SuperscriptBox["\[Alpha]2", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
               "\[Rho]s"}], "+", 
              RowBox[{
               SuperscriptBox["2", "\[Beta]1"], " ", 
               SuperscriptBox["F2", "\[Beta]1"], " ", 
               SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
               SuperscriptBox["\[Alpha]2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["\[Rho]s", "2"]}], "+", 
                 RowBox[{"\[Beta]1", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", 
                    SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["4", "\[Beta]1"], " ", 
             SuperscriptBox["F2", 
              RowBox[{"2", " ", "\[Beta]1"}]], " ", 
             SuperscriptBox["\[Alpha]1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["X2", "2"], " ", 
             SuperscriptBox["\[Alpha]2", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"1", "+", "\[Beta]1"}]], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
             " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Alpha]s", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["4", "\[Beta]1"], " ", 
            SuperscriptBox["F2", 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", "2"], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"1", "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
            " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRspreadC", "[", 
    RowBox[{
    "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_",
      ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
     "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
      RowBox[{"X2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
    RowBox[{"\[Alpha]s", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", 
         RowBox[{"2", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
        "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{"-", "F2"}], ",", "1"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
    SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "X2", " ", "\[Alpha]1", 
    " ", "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], 
  RowBox[{"\[Alpha]s", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["X2", "2"], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
      "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
       RowBox[{"X2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
     RowBox[{"\[Alpha]s", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative2", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
         RowBox[{"2", " ", "X2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
          "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", 
             RowBox[{"2", " "}]], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
            "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], ")"}], 
        "3"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["F2", "\[Beta]2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Beta]1", " ", 
        "\[Rho]s"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData["Spreadoption"], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Utilise", " ", "une", " ", "integration", " ", "numerique", " ", "pour", 
   " ", "le", " ", "calcul", " ", "du", " ", "z"}], ",", " ", 
  RowBox[{"Fait", " ", "des", " ", "tas", " ", 
   RowBox[{"d", "'"}], "affichage"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "zb", ",", "b1", ",", "b2", ",", 
      "SqB0B\[Alpha]z", ",", "favg", ",", "zavg", ",", "Ck", ",", 
      "\[Alpha]sp", ",", "\[Nu]sp", ",", "\[Rho]sp", ",", "\[Mu]sp", ",", 
      "X1", ",", "X2", ",", "Qs", ",", "Q1", ",", "Q2", ",", "Qb", ",", "C1", 
      ",", "C2", ",", "C1p", ",", "C2p", ",", "Q", ",", "COV", ",", "COV1", 
      ",", "COV0", ",", "\[Rho]sb", ",", "\[Rho]s\[Alpha]1", ",", 
      "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", 
      ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",", "X2", ",", 
         "\"\< \[Alpha]sp=\>\"", ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"BiSABRz", "[", 
        RowBox[{
        "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
         "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zb", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:z=\>\"", ",", "z", ",", "\"\<zb=\>\"", ",", 
         "zb"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:K=\>\"", ",", "K", ",", 
         "\"\< b1:Cprime[favg]=\>\"", ",", "b1", ",", 
         "\"\< Csecond[favg]=\>\"", ",", "Csecond", ",", " ", "\"\< b2=\>\"", 
         ",", "b2", ",", "\"\< Cfavg=\>\"", ",", "Cfavg"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:intrinsec Value=\>\"", ",", "intrinsec", ",", 
         "\"\<  z=\>\"", ",", "z", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", 
         "SqB0B\[Alpha]z"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C1", "=", 
         RowBox[{"F1", "^", "\[Beta]1"}]}], ";", 
        RowBox[{"C2", "=", 
         RowBox[{"F2", "^", "\[Beta]2"}]}], ";", 
        RowBox[{"C1p", "=", 
         RowBox[{"\[Beta]1", " ", 
          RowBox[{"F1", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]1", "-", "1"}], ")"}]}]}]}], ";", 
        RowBox[{"C2p", "=", 
         RowBox[{"\[Beta]2", " ", 
          RowBox[{"F2", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]2", "-", "1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Alpha]1", "2"], " ", 
            SuperscriptBox["C1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["\[Alpha]2", "2"], " ", 
            SuperscriptBox["C2", "2"]}], "-", 
           RowBox[{
           "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", " ",
             "C2"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qs", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", "  ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qb", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", " ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", 
           "C2p"}], "+", 
          RowBox[{
           SuperscriptBox["\[Alpha]2", "2"], " ", "C2", " ", "C2p"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Q1", "=", 
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox["C1", "2"]}], "-", 
          RowBox[{"\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", "C2"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Q2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]1"}], " ", "\[Rho]s", " ", "C1", " ", "C2"}],
           "+", 
          RowBox[{"\[Alpha]2", " ", 
           SuperscriptBox["C2", "2"]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]sb", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
            RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]1", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
          "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]2", "=", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]1", "=", "\[Rho]c21"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]2", "=", "\[Rho]2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV0", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Alpha]1", "2"], " ", 
              SuperscriptBox["C1", "2"]}], ",", 
             "                                                          ", 
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                         ", 
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                    ", 
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                                         ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", 
             "                                            ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                        ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc12", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc21", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV1", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Alpha]1", "2"], " ", 
               SuperscriptBox["C1", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["\[Alpha]2", "2"], " ", 
               SuperscriptBox["C2", "2"]}], "-", 
              RowBox[{
              "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", 
               " ", "C2"}]}], ",", "       ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], " ", ",", "     ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              "\[Nu]1", " ", "\[Alpha]1"}], ",", "     ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]1", "  ", "\[Alpha]1"}], ",", "             ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}], ",", "                ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"COV", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["Q", "2"], ",", 
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             " ", ",", 
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", " ", "\[Alpha]1"}], 
             ",", 
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", 
              " ", "\[Alpha]1"}], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", "  ", "\[Alpha]1"}],
              ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ",
               "\[Alpha]1"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", "\[Alpha]2"}], 
             ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}], " ", ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< COV1-COV=\>\"", ",", 
          RowBox[{"COV1", "-", "COV"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"N1", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"N2", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Qs", "/", "Q"}], ",", 
              RowBox[{"Qb", "/", "Q"}], ",", 
              RowBox[{"Q1", "/", "Q"}], ",", 
              RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Nu]spZ", "=", 
         FractionBox[
          SqrtBox["N2"], "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]spZ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{"COV", ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Qs", "/", "Q"}], ",", 
                RowBox[{"Qb", "/", "Q"}], ",", 
                RowBox[{"Q1", "/", "Q"}], ",", 
                RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}], ")"}], "/", 
          SqrtBox[
           RowBox[{"N2", " ", "N1"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N1=\>\"", ",", "N1"}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N2=\>\"", ",", "N2"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Nu]spZ=\>\"", ",", "\[Nu]spZ"}], 
         "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Rho]spZ=\>\"", ",", "\[Rho]spZ"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:ds=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<BiSABRSpreadOption:\!\(\*SubscriptBox[\(d\[Alpha]\), \(11\)]\)=\
\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:COV=\>\"", ",", "COV"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption: Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Utilise", " ", "une", " ", "integration", " ", "numerique", " ", 
  "pour", " ", "le", " ", "calcul", " ", "du", " ", "z"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "favg", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",",
          "X2", ",", "\"\< z=\>\"", ",", "z"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:b1=\>\"", ",", "b1", ",", "\"\< b2=\>\"", ",",
          "b2", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", "SqB0B\[Alpha]z"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<BiSABRSpreadOption:res=\>\"", ",", "res"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", "res", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRSpreadOptionVol", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
     "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
     ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"NormalImplicitVol", "[", 
    RowBox[{
     RowBox[{"F1", "-", "F2"}], ",", "K", ",", "T", ",", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
      "implicitNormalvols"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"BiSABRSpreadOptionVol", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormalImplicitCorrelation", "[", 
      RowBox[{
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
       "implicitNormalvols"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Debiaisage", " ", 
  RowBox[{"(", 
   RowBox[{
   "symetrisation", " ", "du", " ", "role", " ", "S1", " ", "et", " ", "S2"}],
    ")"}]}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionCorrected", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "\[IndentingNewLine]", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", "\[Nu]2", 
       ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
       "\[Nu]1", ",", 
       RowBox[{"-", "K"}], ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c21", ",", "\[Rho]c12", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "F1", "-", "F2", "-", "K"}], ")"}], "/", "2"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Extended", " ", "BISABR", " ", "spreadoption", " ", 
  RowBox[{"(", 
   RowBox[{"with", " ", "coefficients"}], ")"}]}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"compute", " ", 
   RowBox[{"E", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", "*", "S1"}], "-", 
       RowBox[{"a2", "*", "S2"}], "-", "K"}], ")"}], 
     SubscriptBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "*", "S1"}], "-", 
        RowBox[{"a2", "*", "S2"}], "-", "K"}], ">", "0"}]]}], "]"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "legendrelst_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Application", " ", "numerique"}]], "Input",
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TestCorrelation", "[", 
     RowBox[{
     "\[Rho]1_", ",", "\[Rho]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
      "\[Rho]c12_", ",", "\[Rho]c21_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Test Correlation : Eigenvalues=\>\"", ",", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[Rho]1", ",", "\[Rho]s", ",", "\[Rho]c12"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]1", ",", "1", ",", "\[Rho]c21", ",", "\[Rho]v"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]s", ",", "\[Rho]c21", ",", "1", ",", "\[Rho]2"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]c12", ",", "\[Rho]v", ",", "\[Rho]2", ",", "1"}], 
            "}"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Simple", " ", "execution"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"-", "0.002"}]}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionCorrected", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00757654289844304`", ",", "0.007589450676546244`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.3881481805504236`*^9, 3.3881485054545937`*^9, 
  3.3881485477199483`*^9, 3.438081141342285*^9, 3.43808230947945*^9, 
  3.438083372315612*^9, 3.438085614254923*^9, 3.4380856798160267`*^9, 
  3.6950377675186872`*^9, 3.695037821532845*^9, 3.6950379378553467`*^9, 
  3.6950380347642097`*^9, 3.695038344289894*^9, 3.695038655799117*^9, 
  3.695038917302429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.5"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", 
      RowBox[{"-", "0."}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0035"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionVol", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8421595707239923`", ",", "0.004119050219556402`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.695038669460166*^9, 3.69503892852649*^9}]
}, Open  ]],

Cell[BoxData["Smile"], "Input",
 Background->GrayLevel[0.900008]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
          ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
         ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}]}], 
        "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{
  3.388148567172949*^9, {3.388148635406887*^9, 3.3881486512974105`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.695038678483985*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.6950386784926653`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.695038678565106*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.8645184922281947`", ",", "0.8695172159508083`", ",", 
     "0.8743670616831828`", ",", "0.8790766770862387`", ",", 
     "0.8836545561721881`", ",", "0.8881090818288572`", ",", 
     "0.8924485304783195`", ",", "0.8966810308099487`", ",", 
     "0.9008144641056229`", ",", "0.9048562890212374`", ",", 
     "0.9088132691706357`", ",", "0.9126910783339546`", ",", 
     "0.9164937571409256`", ",", "0.9202229991009933`", ",", 
     "0.9238772562448456`", ",", "0.9274506792638926`", ",", 
     "0.9309319471237076`", ",", "0.9343030968617404`", ",", 
     "0.9375385294695825`", ",", "0.9406044265383875`", ",", 
     "0.9434588389207951`", ",", "0.9460526740954391`", ",", 
     "0.9483316971559674`", ",", "0.9502394883867672`", ",", 
     "0.9517211268011669`", ",", "0.9527272715881687`", ",", 
     "0.9532258225876741`", ",", "0.9532339533286935`", ",", 
     "0.9527461195628966`", ",", "0.9517666845880283`", ",", 
     "0.9503144661832967`", ",", "0.9484192657282366`", ",", 
     "0.9461184651652974`", ",", "0.9434538486089176`", ",", 
     "0.9404687613134889`", ",", "0.937205714173119`", ",", 
     "0.9337045241048997`", ",", "0.9300010333585886`", ",", 
     "0.9261263878072089`", ",", "0.922106798118906`", ",", 
     "0.9179636735351463`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADRCF2vIqrrP4cqusQV0+s/0x/UodD66z89
YFhpZSHsP/cRd+vlRuw/dYm3vGNr7D+FkHg48I7sP6q2yGqcsew/CR7j2njT
7D/toh0tlfTsP3pHqJD/FO0/LHOZ68M07T/1ET236lPtP0NOxYB3cu0/1t8i
CWeQ7T/I7AIMra3tP2hVdssxyu0/hVOym8/l7T8t+lnNUADuPxKRTnRuGe4/
qy5Jl9Aw7j9yEPFBEEbuPxpxIbe7WO4/X6W/pFxo7j+4vlDdf3TuP9RPL+e9
fO4/r++2cNOA7j8Sed995IDuP8Y7HW7lfO4/MUv3Z9907j/eiCXi+WjuPxxf
JlxzWe4/dtpAO5pG7j+78CEgxjDuP7kImPFRGO4/je5/1pb97T+ZDGVP6ODt
P9iu8IaRwu0/wwZzztOi7T8U4aod5oHtP7H7l1r1X+0/5Xqy1w==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.695038678574581*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.219977`", ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], AbsoluteThickness[1.6], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT98xK/TPo4p8z+9s+6rD0lk/d/nav5
cqZRmb3Nff/e6XmT9j/VNOSuPVlqP+eIwoaijIn7t0tOOlidWGr/Z+XHS75J
E/Z7cWvKlf4qsd8h1/o6cEff/scJnxXcppTYV75UM+RY07P/78R93Sf1Suyt
tpwo2ze/a//fv6e+Xz9ZbP8LbF3H/q1acV4eqcX2uzx5mLTb2/YfdKjZ+IGh
2B7ivpb9BmFNCSvmFEHd07R/7TuvEC+LIqj9Dfs9VBeU7rxcaF8Btq9mf7FW
XdWzvEKo+RX7F39zfnyds9C+BmxeyX5Og6MhW5YUQPUX7O9IYvE5b19g/wOs
PmO/mtCdiPzt+fY/wPIJ+/s4em/0fsqzZ1gF4gfsn/pxUVSsMZAPBbE7GESZ
a3Nh8vbvjtxxSLucA9Nvv8R+ZbeYdQ7MfHvbl7xPhXZmw+y3X5GhY5oflA1z
n/3dnNqfd7mB8hD322cu/f5j4YssmP/sp6ywqOED8qH+t9+w5NjZTq5sWPjY
az4/r+non21fBQk/+8762dGvNmfDwtfe8HPKO23THFj420/7vvYN9/kcWPzY
t5b+XxsK9E8VJP7sA7bt2fzGOs9+FyR+7SsFDopwsOfb/4XEvz3jB+/2sNv5
9rMh6cNe6FGPLHt0gb01JP3YV169srzsVAEsfdlLyyX/F7cuhMbvFHvHk8fq
HNYU2gMAFUxFtA==
          "]]}}, {}, {}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0.0031726670490528856`},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
             Part[#, 1]], 
            (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
             Part[#, 1]], 
            (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Implicit Normal Vol\"", TraditionalForm],
      PlotRange->{{-0.02, 0.02}, {0.00328448132656429, 0.005520766876792397}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], ",", 
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], AbsoluteThickness[1.6], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9Fzli1yutem1/+2dd1p6SyfvbtXYd
Eb382t7mvn/v9LxJ+y/LX1l44ddr+zlHFDYUZUzcb5sQkZmq+Mb+z8qPl3yT
Juz/Llj++qnbG/sdcq2vA3f07S/t3L4nOfuNfeVLNUOONT37WydUWHzoe2Nv
teVE2b75XftXbTuRNWfjG/tfYOs69nPKPb5VcfmN/S5PHibt9rb9bxfJ6k79
8sYe4r6W/VXuKyb8F3kLdU/Tfp3ima8Pm7yF2t+w/6ug7fZXwW/tK8D21ex3
9jvaUF70Fmp+xf5r95U40ye8ta8Bm1ey/8QbJp61a2H6C/ZnhJadNjz11v4H
WH3G/tbgTbPPPwXywfIJ+3V/RZ4NYHhnz7AKxA/YLzTRryRPEsiHgtV6ntMv
GMDl7YsEPjoKuL2D6beXKlTcvjviHcx8+/il+5fEZLyD2W+/Y1/A3fqSdzD3
2V/x13++twYoD3G//fr32wouN7yD+c9eqPJ+7ZMGmP4G+2PWsnlPgeqh4WNv
6P09/T7QvCpI+Nnf61B99BNoHzR87WXi1WKKI9/Bwt++7JaD9Syge6HxY7/7
g6LCMaB/qiDxZ7+TY8bHQAmgfkj82ve+q7827e9b+7+Q+LefyZPq/+LBW/vZ
kPRhf2Pdh7aJh97aW0PSj/1htuJzlxe9haUve5GHq2SfNb6Fxu8U+42/p0d9
jX9rDwAMi12K
          "]]}}, {}, {}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0.8600827191731698},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
             Part[#, 1]], 
            (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
             Part[#, 1]], 
            (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
      PlotRange->{{-0.02, 0.02}, {0.8645184922281947, 0.9532339533286935}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.3881485594698734`*^9, 3.3881485686885643`*^9}, 
   3.3881486537973948`*^9, 3.4380857081178303`*^9, 3.695038678671967*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Nouvelle", " ", "implementation", " ", "bas\[EAcute]e", " ", "sur", 
  " ", "normalheston"}]], "Input",
 Background->RGBColor[0.823529, 0.972549, 0.380392]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "1"}],
  FontColor->RGBColor[0, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Theta]", ",", "S0", ",", 
      "\[Kappa]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "\[Mu]sp", " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
              RowBox[{
               SuperscriptBox["\[Nu]sp", "2"], " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
          SuperscriptBox["\[Alpha]sp", "2"]], "]"}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], 
          RowBox[{"2", "\[Lambda]"}]], "]"}], ",", 
        RowBox[{"100", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[Alpha]sp", "^", "2"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Lambda]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRNormalHestonSpreadOption: \[Lambda]=\>\"", ",", 
         "\[Lambda]", ",", "\"\< \[Theta]=\>\"", ",", "\[Theta]", ",", 
         "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Alpha]sp=\>\"", 
         ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"HestonNormalCall", "[", 
      RowBox[{
      "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
       SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380827912939*^9, 3.43808286061928*^9}, {
   3.438082932774144*^9, 3.4380829370396876`*^9}, {3.4380829679922185`*^9, 
   3.4380829855387564`*^9}, {3.4380833318158712`*^9, 3.438083353206359*^9}, 
   3.438083385768651*^9},
 Background->RGBColor[0.94902, 0.843137, 0.615686]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\[Alpha]=\>\"", ",", "\[Alpha]", ",", "\"\< \[Nu]=\>\"", ",", 
        "\[Nu]", ",", "\"\< \[Rho]=\>\"", ",", "\[Rho]", ",", 
        "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Lambda]=\>\"", 
        ",", "\[Lambda]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "2", " "}],
  FontColor->RGBColor[0, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Kappa]", ",", "\[Theta]", ",", 
      "S0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Theta]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]2", "=", "0.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"HestonNormalCall", "[", 
       RowBox[{
       "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
        SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083427205886*^9, 3.4380834528464575`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "}"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.008895426691655233`", ",", "0.00895385030911113`", ",", 
   "0.008323357861024557`"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.4380834943620825`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
   3.4380857571289263`*^9, 3.438085774098433*^9}, 3.695038696948051*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
   3.4380857571289263`*^9, 3.438085774098433*^9}, 3.695038696957014*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$2356"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$2356)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
   3.4380857571289263`*^9, 3.438085774098433*^9}, 3.695038696965568*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
   3.4380857571289263`*^9, 3.438085774098433*^9}, 3.69503869954247*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.86718619633737`", ",", "0.8679974523136006`", ",", 
     "0.8687925193294657`", ",", "0.8695709157598699`", ",", 
     "0.8703321539228683`", ",", "0.8710757409677405`", ",", 
     "0.8718011798930735`", ",", "0.872507970670981`", ",", 
     "0.8731956114862023`", ",", "0.8738636000703581`", ",", 
     "0.8745114351924252`", ",", "0.8751386182000065`", ",", 
     "0.8757446547111747`", ",", "0.8763290563882572`", ",", 
     "0.8768913428067899`", ",", "0.877431043404032`", ",", 
     "0.877947699511411`", ",", "0.8784408664062913`", ",", 
     "0.8789101154497354`", ",", "0.879355036208034`", ",", 
     "0.8797752385871939`", ",", "0.8801703549423286`", ",", 
     "0.8805400421398474`", ",", "0.8808839835380666`", ",", 
     "0.8812018909001675`", ",", "0.8814935061445286`", ",", 
     "0.8817586029798888`", ",", "0.8819969883586538`", ",", 
     "0.8822085037414494`", ",", "0.8823930261498057`", ",", 
     "0.8825504690041321`", ",", "0.8826807826934734`", ",", 
     "0.8827839549359093`", ",", "0.882860010853728`", ",", 
     "0.8829090128076746`", ",", "0.8829310599740149`", ",", 
     "0.8829262876782551`", ",", "0.8828948664817239`", ",", 
     "0.8828370010748535`", ",", "0.8827529289283452`", ",", 
     "0.8826429187881252`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADz+BlE/b/rP+9X1peixus/sPEw+CXN6z+m
uZdihtPrP84wONHC2es/BnR5O9rf6z+pKIiWy+XrP4P/8NWV6+s/ugFL7Dfx
6z/C8e7LsPbrP8gkxGf/++s/UFcUtCIB7D+sM3SnGQbsP3sbtzvjCuw/ogXw
bn4P7D+QS31E6hPsP47/H8YlGOw/6uoVBTAc7D/IXT8bCCDsP87DQiytI+w/
xwCyZh4n7D85WiwFWyrsPzPkeU9iLew/5rebmzMw7D/W3dJOzjLsPzbekN4x
New/GX1Y0V037D8aeIW/UTnsP+VS+lMNO+w/OwWxTJA87D+UJi572j3sP6E8
z8TrPuw/vEP8IsQ/7D/TAzKjY0DsP5BI62bKQOw/lcBmo/hA7D/aakuh7kDs
P58MK7ysQOw/ORbqYTNA7D8rQQYSgz/sPx+2x1ycPuw/IlyorA==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
   3.4380857571289263`*^9, 3.438085774098433*^9}, 3.695038699552945*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.199728`", ",", 
   GraphicsBox[{{}, {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n39Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/ho8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7zxlYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2N///cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/oXIk/f9vmHua9geEi2xRYnwDtb9h/xrjkuWSbG/sK8D21eyv
lt5u/ZjrDdT8iv2LWD/k1fG/sa8Bm1eyf4J3rcsrYZj+gv19/+WPqUq8sf8B
Vp+x/9UrUVYDGSAfLJ+w/0SsvTSHwht7hlUgfsD+c4eddNYqA/lQcJxhU5qc
Olze3jJKhzVaC67f3vhJpX+SLtx8+2fbZ882NoDbb3/t7iW/c0Zw99mb3Ztw
z9AUKA9xv71kbcTFWHO4/+ylKlr3B1rC/W//NOhXMK/1G1j42FuzbvSZYPPG
vgoSfvZT1PSqb9m+gYWv/UKb80de28HCp8N+j/MfpSP2b2DxY3+Z2WhxsgNQ
PyT+7Cd4vE47BeTvgsSv/dQDaYt/APl/IfFvfyvLe+E7IH82JH3Yz+fR3rMG
yLeGpB97S7FXicZAPjR92Ws7sgk1A+2Dpj97+W3HY+YA3QMApmZTXw==
        "]]}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0.8663989531555378},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRange->{{-0.02, 0.02}, {0.86718619633737, 0.8829310599740149}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4380834809558325`*^9, 3.4380834963777075`*^9}, {
   3.438085759101242*^9, 3.4380857748561373`*^9}, 3.6950386996306543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.4380835046902075`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9, 
  3.695038714180908*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9, 
  3.6950387141895113`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$7546"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$7546)],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9, 
  3.695038714198176*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.007236307082792201`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.007413518035210933`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.007236307082792201, "  \[Sigma]ATMnormal2=", 
   0.007413518035210933],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9, 
  3.695038714719137*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.7329452356224134`", ",", "0.736627872644939`", ",", 
     "0.7402754620240658`", ",", "0.7438845993757446`", ",", 
     "0.7474515578376553`", ",", "0.7509722617641611`", ",", 
     "0.754442259776657`", ",", "0.7578566980017768`", ",", 
     "0.761210294049984`", ",", "0.7644973129691723`", ",", 
     "0.7677115467289759`", ",", "0.7708462975016056`", ",", 
     "0.7738943692410436`", ",", "0.7768480677845266`", ",", 
     "0.7796992133066232`", ",", "0.7824391681176202`", ",", 
     "0.7850588831199719`", ",", "0.7875489661734003`", ",", 
     "0.7898997754994498`", ",", "0.7921015401976007`", ",", 
     "0.7941445092078208`", ",", "0.7960191274279996`", ",", 
     "0.7977162362033088`", ",", "0.7992272918562047`", ",", 
     "0.8005445936699145`", ",", "0.8016615092398298`", ",", 
     "0.8025726842007613`", ",", "0.803274221425358`", ",", 
     "0.8037638168116656`", ",", "0.8040408403624433`", ",", 
     "0.8041063562694952`", ",", "0.8039630799395857`", ",", 
     "0.803615276077534`", ",", "0.8030686058671125`", ",", 
     "0.8023299354441954`", ",", "0.8014071209985787`", ",", 
     "0.8003087795131458`", ",", "0.7990440670253649`", ",", 
     "0.7976224658462632`", ",", "0.7960535941385506`", ",", 
     "0.7943470406980861`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACjOxiRSXTnP0mgyp10kuc/wZZtKlaw5z/s
I0oT583nPzI5iIcf6+c//V0P+/YH6D8nwQ4YZCToPxkcn7BcQOg/21fKsNVb
6D+co6IRw3boPwbNPs4Xkeg/+2LA2sWq6D/SXM4fvsPoP/gMo3rw2+g/0s27
w0vz6D+GlsXdvQnpP/bnjc4zH+k/4tO245kz6T+Badzk20bpP01RSFTlWOk/
1g7rvqFp6T8dZuka/XjpP9BnPzPkhuk/PPoSHUWT6T8YqRmyD57pP860lAk2
p+k/P8Tp6Kyu6T+fvNcjbLTpP3JBXeVuuOk/YClA27O66T/U3NVAPbvpP8UF
8ccQuuk/aTUqYje36T8PmNTuvLLpPyG1KtSvrOk/mg3viyCl6T+IvVYoIZzp
Pw76/dzEkek/nqqrjB+G6T/RBhZjRXnpPwogL3xKa+k/tUOxFw==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9, 
  3.695038714729982*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.581558`", ",", 
   GraphicsBox[{{}, {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9i60lJnqWPLe//bMua0/J5P2eC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvZNnRLv/6uf0OudbXgTv69v+N5f/9jf2FfeVLNUOONT371Q/ySaSovLC3
2nKibN/8rv2SMvM3xDi8sP8Ftq5j/+3wUxuuRr+w3+XJw6Td3rZ/zuJFgofL
XthD3Neyn+2s3TnxiS+g7mna/zvpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+y+d3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8b6BHyNALIh4JrfK/3
LcyEy9vLpr2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffbn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/2VO1cdbHe/hIWv/VHWj8cFgPLQ8LfPNNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97vl9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2XAr6NV7Z
L+0Br3xbyg==
        "]]}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0.7293871795900594},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRange->{{-0.02, 0.02}, {0.7329452356224134, 0.8041063562694952}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835073464575`*^9, 3.4380857824060087`*^9, 
  3.6950387148009233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "LegendPosition","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"LegendPosition\\\\\\\"\\\"}]\\) \
appears in multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"PlotLegends`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}]\\); definitions in context \\!\
\\(\\*RowBox[{\\\"\\\\\\\"PlotLegends`\\\\\\\"\\\"}]\\) may shadow or be \
shadowed by other definitions.\"",2,41,1,29201609441749812705,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.695038804816909*^9, 3.6950389445678377`*^9}],

Cell[BoxData[
 TemplateBox[{
  "PlotLegend","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"PlotLegend\\\\\\\"\\\"}]\\) appears \
in multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"PlotLegends`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}]\\); definitions in context \\!\
\\(\\*RowBox[{\\\"\\\\\\\"PlotLegends`\\\\\\\"\\\"}]\\) may shadow or be \
shadowed by other definitions.\"",2,41,2,29201609441749812705,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.695038804816909*^9, 3.695038944592605*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","obspkg",
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"PlotLegends`\\\\\\\"\\\"}]\\) is now \
obsolete. The legacy version being loaded may conflict with current \
functionality. See the Compatibility Guide for updating information.\"",2,41,
   3,29201609441749812705,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.695038804816909*^9, 3.695038944607082*^9}],

Cell[BoxData[
 TemplateBox[{
  "Set","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"ListLinePlot\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"SyntaxInformation\\\", \\\"[\\\", \\\"ListLinePlot\\\", \
\\\"]\\\"}]\\) is Protected.\"",2,41,4,29201609441749812705,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.695038804816909*^9, 3.6950389446804047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x1", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
     RowBox[{"\[Rho]c21x2", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
         RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.4380835187370825`*^9, {3.695038758574072*^9, 3.695038759694056*^9}, 
   3.695038868019424*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.6950387267293987`*^9, 3.695038953269236*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.6950387267293987`*^9, 3.695038953278386*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.6950387267293987`*^9, 3.69503895612335*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.6950387267293987`*^9, 3.6950389568124638`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.962814`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {{}, {}, 
         {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[
          0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9i60lJnqWPLe//bMua0/J5P2eC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvZNnRLv/6uf0OudbXgTv69v+N5f/9jf2FfeVLNUOONT371Q/ySaSovLC3
2nKibN/8rv2SMvM3xDi8sP8Ftq5j/+3wUxuuRr+w3+XJw6Td3rZ/zuJFgofL
XthD3Neyn+2s3TnxiS+g7mna/zvpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+y+d3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8b6BHyNALIh4JrfK/3
LcyEy9vLpr2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffbn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/2VO1cdbHe/hIWv/VHWj8cFgPLQ8LfPNNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97vl9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2XAr6NV7Z
L+0Br3xbyg==
           "]]}, 
         {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[
          0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9K542CPlIPbW//bMua0/J5P2fNh36
keD51N7mvn/v9LxJ+3fO3i1VWPHUfs4RhQ1FGRP3X7vKk1e1/Kn9n5UfL/km
TdgvU/1madW1p/Y75FpfB+7o25/lxK2dz/rMvvKlmiHHmp79umuLhUJNntlb
bTlRtm9+136NhfrCmsnP7H+BrevYn/FqV9Xzic/sd3nyMGm3t+2vu5iv0HPg
mT3EfS379cIvhwm9fwZ1T9P+1t1PbpfIPofa37B/7wGf42u9n9tXgO2r2W96
73jZtsrnUPMr9reXra5oX/7cvgZsXsl+rl2BJRJXYfoL9ivsmiiQwPTC/gdY
fcb+lK12N4L1gXywfML+O6vZZF9Ev7BnWAXiB+yXCXt7g78DyIeC0Kd2/Xs2
w+Xt9729oXvvHly/fcEK6Q9JnC9h5tv3PF3ham78Ema//YFV4ftdY17C3Gef
svsYa3kLUB7ifnv//kN3N65+CfOf/b0fkva3L8L0N9ifODSr+dq3l7DwsX//
ddbmVqlX9lWQ8LOvvBX+9aTNK1j42ps+KlNqiX0FC3/7ktx5LVNrXsHix35a
ZdfWBzOB+iHxZ39zz9OZXluB+iHxa98cGZix+9wr+7+Q+Lf3n1+8Qv7ZK/vZ
kPRhv+2LqHDm71f21pD0Y/+r6L51P99rWPqyr5r17GO//Gto/E6x79++2jtf
77U9AKCwXMA=
           "]]}, 
         {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01],
           LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT92nVhEjObX9nf/lmXtadk8v43MrpL
DXpe2dvc9++dnjdp/wxe4wcvJr+yn3NEYUNRxsT9YdkKfOtmvbL/s/LjJd+k
Cfs5I+INsxe8st8h1/o6cEff/mNHXRS4lr6yr3ypZsixpmf/pamXthSveGVv
teVE2b75XfvjdnzmnbDqlf0vsHUd+036Lz9zW/3KfpcnD5N2e9v+Ur0Ejgag
PMR9LfvZTZMuKq+Auadpv4JG3BXpJTD7G/YnPv7cEjzvlX0F2L6a/b8jpd/s
mAYzv2K/3sRN4ba9r+xrwOaV7Fddy/rjaiNMf8H+V8mTY2tKXtn/AKvP2B8v
pXRaLxXIB8sn7I+fvC74Q/Are4ZVIH7Afv9THAdPOAD5UHBsarbrEW24vH06
073/n0Tg+u1VTC/GZfx5CTPfPu71sTyrRy9h9tvbtDYoNR57CXOffT/vxwWh
K4HyEPfbs/eKLbrY9RLmP/sQJcGHfNkw/Q328efLlql5vYSFj31t995sQ42X
9lWQ8LNPF7Ga5sb6Eha+9lbVTe41D1/Awt9e69pj++d7XsDix37WtxXnZ01/
YV8FiT/7T38zrqwofGG/CxK/9m4dh/cper+w/wuJf/vSfffmiai8sJ8NSR/2
Fa+tTPv/PLe3hqQfe/d0d7Z5V57D0pf9vpMT833WPIfG7xT7K7eq9i5pfm4P
ACaVVJc=
           "]]}}, {}, {}, {{}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, 0.6499621921128425},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImagePadding->All,
       Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
             (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
              Part[#, 1]], 
             (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
              Part[#, 2]]}& ), "CopiedValueFunction" -> ({
             (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
              Part[#, 1]], 
             (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
              Part[#, 2]]}& )}},
       PlotLabel->FormBox[
        "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
       PlotRange->{{-0.02, 0.02}, {0.6594601022144859, 0.8494183042473525}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {
          Scaled[0.05], 
          Scaled[0.05]}},
       Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
       {GrayLevel[0], 
        RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
        GraphicsGroupBox[{
          RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
           GraphicsBox[{{{InsetBox[
                GraphicsBox[{
                  {RGBColor[0, 0, 1], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[{
                  {RGBColor[0., 1, 0.], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[{
                  {RGBColor[1, 0., 0], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
            AspectRatio->1.0952380952380953`,
            FormatType->TraditionalForm,
            
            PlotRange->{{-0.1, 3.26}, {-0.1, 
             3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
           Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->{401.86328125, Automatic},
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835274089575`*^9, 3.43808579513346*^9, 
  3.695038728680806*^9, 3.6950389601685333`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
      RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
      RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}], ",", "callvalues2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.020"}], ",", "0.02", ",", "0.001"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}],
            "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRSpreadOption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", 
             "legendrelst", ",", "0"}], "]"}], "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"callvalues", ",", 
          RowBox[{"PlotLabel", "->", "\"\<Heston BiSABR\>\""}]}], "]"}], 
        "\[RawEscape]"}], "]"}], "\[RawEscape]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"callvalues2", ",", 
        RowBox[{"PlotLabel", "->", "\"\<BiSABR\>\""}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<correlation \[Rho] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Nu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Mu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Lambda] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.438085824272683*^9, 3.438085866155608*^9}, {
   3.438085901336306*^9, 3.4380859221525373`*^9}, 3.6950394266305428`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.695039429051262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.695039429057599*^9}],

Cell[BoxData[
 RowBox[{"\[RawEscape]", " ", 
  GraphicsBox[{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DeVtBcXRBva3f9Zl7SmZvJ9BceNV
16lG9jb3/Xun503a7xD/+W6BlKn9nCMKG4oyJu4/ULxRsvSLuf2flR8v+SZN
2H/A7XLnK11r+x1yra8Dd/TtZ7h2e//MS3b2lS/VDDnW9OxPONu59FS5o73V
lhNl++Z37V9Q9T555Uln+19g6zr2O9QGhz1Mc7Pf5cnDpN3etj8h4OBVowhP
e4j7WvZv+LtNQn+5D9Q9Tfs1RG155fUDoPY37FeIme0V4BJkXwG2r2Y/g3Zl
mtnMEKj5FfsdnmolOpmE29eAzSvZ7/DNRNVJJgqqv2D/idL6Q0ERsfY/wOoz
9l/4VTjpWXmC/Q+wfMJ+nzSVGLHSJHuGVSB+wP4l63dfL1+eYs8ABS2pHs07
hNJh8vbLcgPy43ZlwvTby128ZL5hYQ7MfPt5WxX3zT6dD7Pf/rKkS5nf3EKY
++y3tqayB1cU2/+BuN/ehK3wt3V2Mcx/9gwXeTbGlBXC/G+/UG72trfe+bDw
sS/adZzd53O2fRUk/Ox7Uy78DX+YAQtfe+P/DlXvhNNg4W8/88LCyoiOZFj8
2LvyWu9Psk60r4LEn333iQaRj0Fx9rsg8Wsvz9PJUD83yv4vJP7tneL5jdL8
wu1nQ9KHvdvGSqea2BB7a0j6sU+TeTBl0aFAWPqy5+27M+HGaz9o/E6x/1Xv
/aXivpc9ALjiOo0=
       "]]}, {}}, {}, {}, {{}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   ImageSize->{355.14453125, Automatic},
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox["\"Heston BiSABR\"", TraditionalForm],
   PlotRange->{{-0.02, 0.02}, {0, 0.004753422099697803}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}]}]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.6950394293808813`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DXYi87mSXexv/6zL2lMyef8B77iN
62td7W3u+/dOz5u0/0CF45WKrW72c44obCjKmLi/QaT18mxeD/s/Kz9e8k2a
sN/hWUHkjk5P+x1yra8Dd/TtX3DPVOKprrd95Us1Q441PfsVkrMX7/vnY2+1
5UTZvvld+w9cFFCvYPS3/wW2rmO/wY986e9zA+x3efIwabe37d/Q6M0cdyvQ
HuK+lv0eFzbuX2kZDHVP0/6Eb0L5PAdCoPY37A+YzJPjWBRmXwG2r2b/jdqH
EQtCI6DmV+y/MSFWyqQgyr4GbF7J/gcxb95dOxED1V+w32HCnbMh6fH2P8Dq
M/abPPQN9dJKtP8Blk/Yv2fuq8PJZ5PsGVaB+AH79zhERp1ZlGLPAAUZioqG
WhvTYPL2dZuuFPz4nwHTb58xlz8/b3o2zHx7iwlPec0b8mD222e+Y/9d/LAA
5j77P9bcM2duLrL/A3G//Z1O3vzJa4pg/rPvYJsQX3OqAOZ/+3zhIxMUjfJg
4WOf8t+63083274KEn728t2757Q2ZMDC137R9pd7JFTSYOFvf3lFxoWJ/Cmw
+LFP+996u8Aqyb4KEn/2PprPHq+dk2C/CxK/9tXnReWY4+Ls/0Li3/7Skrr9
TNei7WdD0od90UaWQttpkfbWkPRj38Cm7q09NRyWvuw7WkszV54KhcbvFPso
Rw/x4/oh9gAvZD22
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"BiSABR\"", TraditionalForm],
  PlotRange->{{-0.02, 0.02}, {0, 0.00456581114913401}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.695039429439391*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"correlation \[Rho] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}]}],
  SequenceForm["correlation \[Rho] spread=", -0.1166587353908298],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.69503942945183*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Nu] spread=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`"}],
  SequenceForm["\[Nu] spread=", 0.31830374813276047`],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.695039429460218*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Mu] spread=\"\>", "\[InvisibleSpace]", 
   "0.000781149540185173`"}],
  SequenceForm["\[Mu] spread=", 0.000781149540185173],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.69503942946887*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$46177"}]}], ")"}]}]}],
  SequenceForm[
  "\[Lambda] spread=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$46177)],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.69503898492162*^9, 
  3.695039429478902*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.401446`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.4380859255048656`*^9, 3.69503898542662*^9, 
  3.695039429488302*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.11665"}]}], ",", 
     RowBox[{
     "\[Lambda]v", "=", "\[InvisibleSpace]\[InvisibleSpace]", 
      "0.09975497699499274"}], ",", 
     RowBox[{"StdDev", "=", "0.00413158"}], ",", 
     RowBox[{"\[Kappa]", "=", "\[InvisibleSpace]", "0.00263019"}], ",", 
     RowBox[{"S0", "=", "0.005"}], ",", "V", ",", 
     RowBox[{"\[Tau]1", "=", "3"}], ",", 
     RowBox[{"\[Tau]2", "=", "10"}], ",", 
     RowBox[{"\[Tau]3", "=", "30"}], ",", "Vinfini", ",", "toplot", ",", 
     "tim"}], "}"}], ",", 
   RowBox[{
    RowBox[{"tim", "=", 
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        SuperscriptBox["StdDev", "2"]}], ";", 
       RowBox[{"Vinfini", "=", 
        FractionBox[
         SuperscriptBox["\[Kappa]", "2"], 
         RowBox[{"2", "\[Lambda]v"}]]}], ";", 
       RowBox[{"toplot", "=", 
        RowBox[{"Plot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NormalImplicitVol", "[", 
             RowBox[{"S0", ",", "k", ",", "\[Tau]1", ",", 
              RowBox[{"HestonNormalCall", "[", 
               RowBox[{
               "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", 
                ",", "V", ",", "S0", ",", "k", ",", "\[Tau]1"}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"NormalImplicitVol", "[", 
             RowBox[{"S0", ",", "k", ",", "\[Tau]2", ",", 
              RowBox[{"HestonNormalCall", "[", 
               RowBox[{
               "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", 
                ",", "V", ",", "S0", ",", "k", ",", "\[Tau]2"}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"NormalImplicitVol", "[", 
             RowBox[{"S0", ",", "k", ",", "\[Tau]3", ",", 
              RowBox[{"HestonNormalCall", "[", 
               RowBox[{
               "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", 
                ",", "V", ",", "S0", ",", "k", ",", "\[Tau]3"}], "]"}]}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "StdDev"}], ",", 
            RowBox[{"8", " ", "StdDev"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5", ",", "0.5", ",", "0."}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5", ",", "0.5"}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5", ",", "0.", ",", "0.5"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotLegend", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<T=\>\"", "<>", 
              RowBox[{"ToString", "[", "\[Tau]1", "]"}]}], ",", 
             RowBox[{"\"\<T=\>\"", "<>", 
              RowBox[{"ToString", "[", "\[Tau]2", "]"}]}], ",", 
             RowBox[{"\"\<T=\>\"", "<>", 
              RowBox[{"ToString", "[", "\[Tau]3", "]"}]}]}], "}"}]}], ",", 
          RowBox[{"LegendPosition", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0."}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "->", "\"\<NormalHeston: imp. vol.\>\""}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<timing=\>\"", ",", 
      RowBox[{"tim", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.4380835763464575`*^9, 3.4380836581902075`*^9}, {
  3.4380836916589575`*^9, 3.4380837012527075`*^9}, {3.4380841849089575`*^9, 
  3.4380842056902075`*^9}, {3.6950391609388027`*^9, 3.695039284706654*^9}, {
  3.6950395743485537`*^9, 3.6950395843364964`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing=\"\>", "\[InvisibleSpace]", "0.11611`"}],
  SequenceForm["timing=", 0.11611],
  Editable->False]], "Print",
 CellChangeTimes->{3.695039290490943*^9, 3.6950395865927277`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"T", "=", "10"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x1", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
      RowBox[{"\[Rho]c21x2", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}], ";"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.695039668650796*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.695039668658197*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.695039669179891*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6950396698650293`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.905132`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.695039672744713*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestExecution", "[", "T_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", "callvalues", ",", 
       "implicitNormalvols", ",", "strikevalues", ",", "k", ",", 
       "implicitcorrelations", ",", "implicitcorrelations2", ",", 
       "implicitcorrelations3", ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c12x1", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c21x2", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
           ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabr:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438085992778808*^9, 3.43808599361532*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "2", "]"}]], "Input",
 CellChangeTimes->{3.438086002168825*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9, 3.695039700183804*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9, 3.695039700192956*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9, 3.695039700202716*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9, 3.695039700212834*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {{}, {}, 
       {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT96U/+ra2temp/+2dd1p6Syft3v8mu
vLX6qb3Nff/e6XmT9h/6ZN+sfPep/ZwjChuKMibuL9PZ9yCY75n9n5UfL/km
Tdh/ZtXkTan2z+x3yLW+DtzRt79FZ6pRUMEz+8qXaoYca3r2X6j9mSe48Jm9
1ZYTZfvmd+3nOLSIbdbFZ/a/wNZ17K8VfPHhAeNz+12ePEza7W37Je7LKd00
fG4PcV/LfmfetzLFic+h7mnaX8WXVTZnwnOo/Q37iwsiDO33P7evANtXsz+J
Z+53h7fPoeZX7F+1JU+nSeqFfQ3YvJL9DWd+nb7j9gKqv2B/xeeN3MpFL+x/
gNVn7Bdlf39Vdg6QD5ZP2P8waopA95EX9gyrQPyA/c13fZ9JvwbyoeBbQm9O
Mf9LmLz90+tv+dQMX8L029tEn9+yy/8lzHx7/rLWaeuyXsLst5+VG7q7pvEl
zH32v55uil85GSgPcb/96g1yghcWvIT5z34T14rGjStg+hvst22IYLNd/RIW
PvbtcUKdk4DyVZDws7/+Vyz6D1A/NHztL8l1uD+e8hIW/vYKEtJHDrS8hMWP
fUHn6iVChUD9kPizV63aKRcUBdQPiV/7otPn4t85vLT/C4l/e/6GPEEv1Zf2
syHpw/5397Jbu9hf2ltD0o/9P7PbPF0vXsDSl71+scqzr8dfQON3iv2b6a1v
jZa9sAcAqbRZCA==
         "]]}, 
       {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[0.01],
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT963Zp9x1SfmR/+2dd1p6SyfsnJJpb
W+U8sre57987PW/Sfrm8/2ovtjyyn3NEYUNRxsT90zbrLjn795H9n5UfL/km
Tdi/JyPq0mu3x/Y75FpfB+7o2/9aeP0v5wmP7StfqhlyrOnZ37RdzOv6zcf2
VltOlO2b37W/Jb03ZpnyE/tfYOs69s8WvBO1KfeJ/S5PHibt9rb9+tsu7vm9
/Yk9xH0t+wsqFfY1MT2FuqdpP2feL31336dQ+xv2Twn95Ocx46l9Bdi+mv1/
GpQntDx+CjW/Yn9boVr8T71n9jVg80r2twVcPrCo6hlUf8F+q81XblYde2b/
A6w+Y/9e+3yPSqHn9j/A8gn7L7c1mEyKe27PsArED9h/x3uGyNZVQD4U3Fi2
5MWpb3B5+5Upd45udnoB02//9fL/TOe+FzDz7e+vvNJpc/MFzH57IZaiqV7K
L2Hus384c9HHn9kv7f9A3G8vUyabs37TS5j/7D9z/jVc+O0lzP/2UnoWj66a
vYKFj33ypXOhBkWv7Ksg4Weval03qXf5K1j42psmOX//dPUVLPztyxc969j3
5xUsfuwXmBhFHpF+bV8FiT979k2NP72NX9vvgsSvfd65Cbc+Ob+2/wuJf/sT
Nx71tvi9tp8NSR/2nJIBtjeCX9tbQ9KPvUjH9987Q17D0pe9bvibovuBr6Hx
O8U+o5+5/on3a3sAm1dd1A==
         "]]}, 
       {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9ttv3e3xof2l/+2dd1p6SyftP5/Lu
37nwpb3Nff/e6XmT9q/qWMTEs/ul/ZwjChuKMibu9w7Q/Hrt8kv7Pys/XvJN
mrC/JKo3gOXNS/sdcq2vA3f07Tf9bHq1jvmVfeVLNUOONT3760OM9mlKvbK3
2nKibN/8rv279gnVPdF/Zf8LbF3HfsfLR8M7XF7Z7/LkYdJub9svt43h/bPw
V/YQ97XsD+t9s+pE5iuoe5r2B9Z1K76ufAW1v2H/Ren2g//aX9lXgO2r2f9b
hG/Kkskw8yv2917cZJ4z55V9Ddi8kv0vN5+3ubQQpr9g/4meZjnHxa/sf4DV
Z+zPqO1+IrwAyAfLJ+w3DP6gt2D6K3uGVSB+wH4ZXZZdrp1APhTsTrxr0VoC
l7cP3Sa6XjISrt8+65WPLI853Hz7iJ28RTv44Pbbf8t9z37gwUuY++xvv32w
5N1aYPhC3G+f8/RBhkz5S5j/7Ll8RR6K2sLCv8Fe7vohsT4GWHw12fMoq86V
PPTCvgoSfvY8B5e06Te9gIWv/ZLpQta6ji9g4W9fOC1DKfr/c1j82J+ZlyPw
cc9z+ypI/Nl/kLvFIlX13H4XJH7t1y5/qfrd7Ln9X0j826cuCBde9PmZ/WxI
+rB/tfDYSr0Nz+ytIenH3ozHLXxNzjNY+rKXaVZRUNd8Bo3fKfataslJK54+
tQcAaxdSAg==
         "]]}}, {}, {}, {{}, {}}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->{True, True},
     AxesLabel->{None, None},
     AxesOrigin->{0, 0.5525038642455119},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     ImagePadding->All,
     Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}},
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=2\"", TraditionalForm],
     PlotRange->{{-0.02, 0.02}, {0.5668652321599745, 0.8540925904492291}},
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}},
     Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380842889558325`*^9, 3.6950397076827993`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "10", "]"}]], "Input",
 CellChangeTimes->{3.43808600846496*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842891902075`*^9, 3.695039727939232*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842891902075`*^9, 3.695039727947936*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842891902075`*^9, 3.6950397279586153`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842891902075`*^9, 3.695039727968128*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {{}, {}, 
       {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9i60lJnqWPLe//bMua0/J5P2eC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvZNnRLv/6uf0OudbXgTv69v+N5f/9jf2FfeVLNUOONT371Q/ySaSovLC3
2nKibN/8rv2SMvM3xDi8sP8Ftq5j/+3wUxuuRr+w3+XJw6Td3rZ/zuJFgofL
XthD3Neyn+2s3TnxiS+g7mna/zvpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+y+d3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8b6BHyNALIh4JrfK/3
LcyEy9vLpr2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffbn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/2VO1cdbHe/hIWv/VHWj8cFgPLQ8LfPNNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97vl9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2XAr6NV7Z
L+0Br3xbyg==
         "]]}, 
       {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[0.01],
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9K542CPlIPbW//bMua0/J5P2fNh36
keD51N7mvn/v9LxJ+3fO3i1VWPHUfs4RhQ1FGRP3X7vKk1e1/Kn9n5UfL/km
TdgvU/1madW1p/Y75FpfB+7o25/lxK2dz/rMvvKlmiHHmp79umuLhUJNntlb
bTlRtm9+136NhfrCmsnP7H+BrevYn/FqV9Xzic/sd3nyMGm3t+2vu5iv0HPg
mT3EfS379cIvhwm9fwZ1T9P+1t1PbpfIPofa37B/7wGf42u9n9tXgO2r2W96
73jZtsrnUPMr9reXra5oX/7cvgZsXsl+rl2BJRJXYfoL9ivsmiiQwPTC/gdY
fcb+lK12N4L1gXywfML+O6vZZF9Ev7BnWAXiB+yXCXt7g78DyIeC0Kd2/Xs2
w+Xt9729oXvvHly/fcEK6Q9JnC9h5tv3PF3ham78Ema//YFV4ftdY17C3Gef
svsYa3kLUB7ifnv//kN3N65+CfOf/b0fkva3L8L0N9ifODSr+dq3l7DwsX//
ddbmVqlX9lWQ8LOvvBX+9aTNK1j42ps+KlNqiX0FC3/7ktx5LVNrXsHix35a
ZdfWBzOB+iHxZ39zz9OZXluB+iHxa98cGZix+9wr+7+Q+Lf3n1+8Qv7ZK/vZ
kPRhv+2LqHDm71f21pD0Y/+r6L51P99rWPqyr5r17GO//Gto/E6x79++2jtf
77U9AKCwXMA=
         "]]}, 
       {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT92nVhEjObX9nf/lmXtadk8v43MrpL
DXpe2dvc9++dnjdp/wxe4wcvJr+yn3NEYUNRxsT9YdkKfOtmvbL/s/LjJd+k
Cfs5I+INsxe8st8h1/o6cEff/mNHXRS4lr6yr3ypZsixpmf/pamXthSveGVv
teVE2b75XfvjdnzmnbDqlf0vsHUd+036Lz9zW/3KfpcnD5N2e9v+Ur0Ejgag
PMR9LfvZTZMuKq+Auadpv4JG3BXpJTD7G/YnPv7cEjzvlX0F2L6a/b8jpd/s
mAYzv2K/3sRN4ba9r+xrwOaV7Fddy/rjaiNMf8H+V8mTY2tKXtn/AKvP2B8v
pXRaLxXIB8sn7I+fvC74Q/Are4ZVIH7Afv9THAdPOAD5UHBsarbrEW24vH06
073/n0Tg+u1VTC/GZfx5CTPfPu71sTyrRy9h9tvbtDYoNR57CXOffT/vxwWh
K4HyEPfbs/eKLbrY9RLmP/sQJcGHfNkw/Q328efLlql5vYSFj31t995sQ42X
9lWQ8LNPF7Ga5sb6Eha+9lbVTe41D1/Awt9e69pj++d7XsDix37WtxXnZ01/
YV8FiT/7T38zrqwofGG/CxK/9m4dh/cper+w/wuJf/vSfffmiai8sJ8NSR/2
Fa+tTPv/PLe3hqQfe/d0d7Z5V57D0pf9vpMT833WPIfG7xT7K7eq9i5pfm4P
ACaVVJc=
         "]]}}, {}, {}, {{}, {}}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->{True, True},
     AxesLabel->{None, None},
     AxesOrigin->{0, 0.6499621921128425},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     ImagePadding->All,
     Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}},
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
     PlotRange->{{-0.02, 0.02}, {0.6594601022144859, 0.8494183042473525}},
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}},
     Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380842975808325`*^9, 3.695039733944646*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "20", "]"}]], "Input",
 CellChangeTimes->{3.4380860117845993`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842977995825`*^9, 3.695039741268474*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842977995825`*^9, 3.695039741275215*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842977995825`*^9, 3.6950397412850447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842977995825`*^9, 3.6950397412949057`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {{}, {}, 
       {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9JUk/bl2Z9NL+9s+6rD0lk/c7ekpa
1C58aW9z3793et6k/T/+5D59sv6l/ZwjChuKMibuL7y3/wDHvpf2f1Z+vOSb
NGH/bEXtrqenX9rvkGt9Hbijb79D14kn5Tdf2le+VDPkWNOz/9HmReF7nr20
t9pyomzf/K79ftcE/dd/fmn/C2xdx367rno5X4ZX9rs8eZi029v2z0hZyzSJ
55U9xH0t+0UOFahUSbyCuqdp/7UktjmMKq+g9jfs//njW4mK/iv7CrB9Nfvf
fp+z6Z7lK6j5FfvNWRxCdVxe2deAzSvZP2X2vXhOP5j+gv3/5nbeKwx/Zf8D
rD5jf9r/8LeJCUA+WD5hf8LzW/uvZryyZ1gF4gfsdxPgWXmyAMiHAqXCVmWr
Cri8/RaBHzeV6+H67VdNX7u+uRVuvn2xw6cTYd1w++27/LQmz5oAd5+98oby
Mz5TgfIQ99u/s1jRlT0T7j/7TSFejl/nwP1vf7d887EX8+HhYy/p8iDcddEr
+ypI+Nlv3fBrFtcSePjaV3N3LLBYCgufDvu8g+qPzwP50Pixv5H3zvUikF8F
iT/7ixfDBe2A/F2Q+LU/cZHrvTjQvL+Q+LfXCEl5kgC0bzYkfdgvWC/iI73g
lb01JP3Y32p7ds5z7itY+rKfXvc9+v1MWPxOsf9dk6/AP+2VPQClPl0s
         "]]}, 
       {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[0.01],
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT99S8/NL1XemF/+2dd1p6SyfvjsxzX
PLJ5YW9z3793et6k/fuXH5h+IOyF/ZwjChuKMibuZ+Stetle8ML+z8qPl3yT
Juyf3xtjYN71wn6HXOvrwB19+w90sj89s/iFfeVLNUOONT37fxRmZLjvfWFv
teVE2b75XfvTPoYwLb32wv4X2LqO/RrfBR48fv/CfpcnD5N2e9t+oxNHhZg4
X9pD3Neyn7vzRe9fxZdQ9zTt178zWfWK1Uuo/Q37H9271dMc/NK+Amxfzf63
lgwhnDkvoeZX7D/+6sizpJaX9jVg80r2W8yZ0dU7B6a/YL9NzYuYti0v7X+A
1WfsZz6eGuh1BsgHyyfsD3DJNrj2+KU9wyoQP2B/36W2qWq/gXwoyLOQf2cu
9Aomb/9zV0YFm+YrmH77rDnTnPrsX8HMt2/hKNY6HfoKZr/9MvGSuzuyX8Hc
Z38iJPxmUCNQHuJ++xsdublTpr2C+c8+KnL7norVMP0N9hl6dw/82v8KFj72
5/5b+YleeWVfBQk/+3sZApKHn7+Cha99z6LXu//9egULf/sJTdX7D/G+hsWP
fbfJocWcCq/tqyDxZy/gu/XVWcPX9rsg8WvPVRGpwuX82v4vJP7t5z+S+bMj
+LX9bEj6sN+jmOp+Nfm1vTUk/djH9KuLRhW/hqUv+7JN7/Y6Nb2Gxu8U++7S
+C9dE17bAwAhelmZ
         "]]}, 
       {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9wirqog21r+1v/6zL2lMyef/yIsNl
qdWv7W3u+/dOz5u0v/SK+ZOdFa/t5xxR2FCUMXH/IvY8k8rS1/Z/Vn685Js0
YX9Bfo/fgsLX9jvkWl8H7ujbf2Qfq4dO7mv7ypdqhhxrevarnW+aJ5Xx2t5q
y4myffO79vOW2jpmJr22/wW2rmO/X4LATLGY1/a7PHmYtNvb9hstPdWnGPra
HuK+lv07FVb1d/rC3NO0X2XhjX4/V5j9DfvnvFjDVWjz2r4CbF/N/suq9xk+
GcHMr9hvpLX4yyWN1/Y1YPNK9r/4fvmxqBxMf8F+pRfxDnuFXtv/AKvP2H+5
IfD5aTYgHyyfsP9W6XQx11+v7BlWgfgB+/tNGZJ03gL5ULCRaf3y1vtweftw
xiCW0IuvYPrtXTakH5936BXMfPty3Xvp6Ztfwey3Z3mgUbl58SuY++wbLggs
bJ8MlIe4335NSHDfi6ZXMP/ZV37n+3CrEKa/wf7LtvC85IRXsPCxL75ftLjN
75V9FST87KdPtBTztHkFC1/7bmMv0/War2Dhb2+6RjR4r9grWPzYu2ZvWVTO
DNQPiT/7Rx6Fpo/ev7TfBYlf+3sp338w3Hlp/xcS//Y5EgLbrh9/aT8bkj7s
j3Tf48/a/NLeGpJ+7A/ktDfvnvcSlr7sN/GbZpzvfAmN3yn2W5+mvF9R8tIe
AF9WUdY=
         "]]}}, {}, {}, {{}, {}}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->{True, True},
     AxesLabel->{None, None},
     AxesOrigin->{0, 0.7489081093472832},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     ImagePadding->All,
     Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}},
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=20\"", TraditionalForm],
     PlotRange->{{-0.02, 0.02}, {0.7542645986025461, 0.8613943837078052}},
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}},
     Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843041589575`*^9, 3.695039746512925*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "30", "]"}]], "Input",
 CellChangeTimes->{3.438086015968822*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9, 3.695039750053059*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9, 3.695039750064413*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9, 3.695039750074523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9, 3.695039750083782*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {{}, {}, 
       {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n39Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/ho8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7zxlYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2N///cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/oXIk/f9vmHua9geEi2xRYnwDtb9h/xrjkuWSbG/sK8D21eyv
lt5u/ZjrDdT8iv2LWD/k1fG/sa8Bm1eyf4J3rcsrYZj+gv19/+WPqUq8sf8B
Vp+x/9UrUVYDGSAfLJ+w/0SsvTSHwht7hlUgfsD+c4eddNYqA/lQcJxhU5qc
Olze3jJKhzVaC67f3vhJpX+SLtx8+2fbZ882NoDbb3/t7iW/c0Zw99mb3Ztw
z9AUKA9xv71kbcTFWHO4/+ylKlr3B1rC/W//NOhXMK/1G1j42FuzbvSZYPPG
vgoSfvZT1PSqb9m+gYWv/UKb80de28HCp8N+j/MfpSP2b2DxY3+Z2WhxsgNQ
PyT+7Cd4vE47BeTvgsSv/dQDaYt/APl/IfFvfyvLe+E7IH82JH3Yz+fR3rMG
yLeGpB97S7FXicZAPjR92Ws7sgk1A+2Dpj97+W3HY+YA3QMApmZTXw==
         "]]}, 
       {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[0.01],
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9tQvfXrj645X97Z91WXtKJu/fP8vp
KSfba3ub+/690/Mm7U/xetphIPzafs4RhQ1FGRP3m56aZ+Kp8Nr+z8qPl3yT
Juxf+GtfdLDua/sdcq2vA3f07Vevf5vtZ/XavvKlmiHHmp79dddfnrF0f21v
teVE2b75XfvdDkU+EAl5bf8LbF3HfoaOPsb7Ca/td3nyMGm3t+2P1fJpnZ77
2h7ivpb9OXcn7rStgrmnaf/tmwlPL7TB7G/Yf9qtwSNg8mv7CrB9Nfv1q4Ol
d8+HmV+x333NjD6BNa/ta8Dmlez/omV32n8HTH/Bfn5F40/lR17b/wCrz9h/
bbetTMcFIB8sn7C/+9e1yPo7r+0ZVoH4AfvXrOLZHPMCyIeCTQey1OW/wOXt
jVU/rD36H67ffp8Ku6k/9xuY+fY2QVMW7RJ7A7PfftdJzitsSm9g7rPXFuqf
Z6QLlIe43z5X3/K8jcUbmP/s5/0L0VZxhulvsH8/43TBc983sPCxV+GbFtYa
8ca+ChJ+9r4zgnv/JL2Bha/9w+lf93vnvoGFv33ks64pheVvYPFj//2F5tqc
RqB+SPzZL5/2a4V1N1A/JH7tRdmSVO9OeWP/FxL/9tNCAvb7z3tjPxuSPuxP
n1olMmn5G3trSPqxN9F/fHTRhjew9GUvcm5BecPON9D4nWJvfrzniuahN/YA
8lVWbA==
         "]]}, 
       {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT90QKzvwmefWN/+2dd1p6SyfvfsH43
3HDyjb3Nff/e6XmT9hc2HJoudOyN/ZwjChuKMibu33D4+m+LQ2/s/6z8eMk3
acJ+g2c7vJT3vbHfIdf6OnBH3/45YVs7L+58Y1/5Us2QY03P/q8Od645b31j
b7XlRNm++V3758rvyaja8Mb+F9i6jv3GOz70lq5+Y7/Lk4dJu71t/7R1jWtM
l72xh7ivZf/M1SKOuxfA3NO0v2Trt7tss2H2N+z/7sOkJTn1jX0F2L6a/U9M
k+9/6oOZX7G//IvzqSkdb+xrwOaV7DdMSj7+vxGmv2C/HN+cQybVb+x/gNVn
7P8RkrjVpATIB8sn7C+2N1/KkPvGnmEViB+w31VdZ9HMVCAfCq6qBB1liIPL
22dwuOubh8H12/csOsxm5wc33974iHW5mBvcfntXqf71B23h7rOPXnHugYMp
UB7ifvt1y4Vtp+rA/WfPPafg235luP/tI0K/2h6SgoePvdXBU05zBd/YV0HC
z/7j5RTDIA54+NovUjtl9Ojfa1j423ve+Jjt9/U1LH7sdykZ/53++rV9FST+
7N+eO8144OFr+12Q+LWvtyjrP379tf1fSPzbB6ULblt/9rX9bEj6sG+sj6iv
PPza3hqSfuzbI1a9U935Gpa+7G38bzFsW/caGr9T7F/0Ca3RWvLaHgDMBFiy

         "]]}}, {}, {}, {{}, {}}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->{True, True},
     AxesLabel->{None, None},
     AxesOrigin->{0, 0.8400175136409174},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     ImagePadding->All,
     Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}},
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=30\"", TraditionalForm],
     PlotRange->{{-0.02, 0.02}, {0.84287539297388, 0.9000329796331344}},
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}},
     Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843101120825`*^9, 3.695039755628573*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "40", "]"}]], "Input",
 CellChangeTimes->{3.438086021488695*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT913dMr9LweGd/+2dd1p6Syfsbnz5e
VOD1zt7mvn/v9LxJ+6tW/T6xxued/ZwjChuKMibuN9ptte6O3zv7Pys/XvJN
mrD/r9FPYYbAd/Y75FpfB+7o21/0bPluseB39pUv1Qw51vTsv+nwPk0h9J29
1ZYTZfvmd+2vO3b2ukz4O/tfYOs69vcH7rrAHfnOfpcnD5N2e9v+U9nHRN5G
vbOHuK9lf2HS4fQDMTD3NO1fUpHW1xoHs79hf7J9gZ9NAsy+mv0aklfyniTC
zK/Yf/v3/e21yTDzSvb/SEr7zJ4K01+wX+reszdNaTD1GfurH20vfJcOk0/Y
H5ChH+iVCeMH7J9/5UzMtKx39gxQELQpIeNSNlzeXvSzsde/HLh+e5fJercl
8+Dm26+3//1NJR9uv73qUq0a+QK4++ynXwv24SyEu98+08PI51Eh3H/2m/8d
TF5VBPe/Pa9VeF1iMTx87KXebO5iL4GHn73bXKnqOSXw8LU/5RPjqlAKD3/7
J3WPH00qhcePvW3G7oAvpfD4s7+iMLnfpQwev/YeWnsXN5fB4x/oX62pG8vg
6cN+5fSU/HNl8PRjn/W4xvFWGTx92S/byCh3tQzmvin2VVdeSO0H8gEdAlq+

        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9vBy+7z1/vbW//bMua0/J5P0PL0YU
uP5/a29z3793et6k/fPcVU9bs7yzn3NEYUNRxsT9Nzn23NThfGf/Z+XHS75J
E/b7if4vkeB7Z79DrvV14I6+/Xv5Fpb8E3pnX/lSzZBjTc/+50ay6++Jv7O3
2nKibN/8rv1iazb83CHzzv4X2LqO/c85AjV6Fd/Z7/LkYdJub9vv7bWEN1rt
nT3EfS37pwSzVitpv4O6p2m//6Vkh8f6MPsb9rMKhOvMNYHZV7M/35ibJ8AS
Zn7F/o3utqt/28LMK9l/tdf8ynwnmP6C/bZqZ/xt3GHqM/Z/awp4esEbJp+w
/wXDnKjYABg/YP8ZRdaShyHv7BmgYNvxhC8xkXB5+0/mzHPPx8L123MuPaBr
mQQ33/6b7MeUmWlw++3tNMv+v8+Cu89+qu6BHTb5cPfbL7p93au+GO4/e4Gf
GXnby+H+tz/49NytJ9Xw8LH/Gqrqxt4ADz/7f58jU+Va4OFrf+qswxvNDnj4
2+/tW9ur2QOPH3vbf72/ZSbA489+UhnHc+Yp8Pi1n2M/j+HedHj827Ne8v+x
ajY8fdgr2hyrzZoPc88k+x7tBgeZxe9g6cu+5xrDh/3LYO6bYv/ZiMUmdNU7
ewDKCVI1
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9//SXNj3b9M7+9s+6rD0lk/dvmLA5
XHjjO3ub+/690/Mm7V/Rr56ut/6d/ZwjChuKMibun5i69Ij52nf2f1Z+vOSb
NGH/CoGv7fqr39nvkGt9Hbijb/8k9qdnRFe+s698qWbIsaZn/+1Sjc2vlr2z
t9pyomzf/K79LBWGceuWvLP/BbauY3/fcfavCYve2e/y5GHSbm/bf0FJZhHT
gnf2EPe17N8iIjl58lyYe5r29yZs/CE8G2Z/w/5783PYWmbA7KvZn1hf9Onx
VJj5FfvzeEO/Gk+GmVeyP7j9lmfJBJj+gv1KfMd1lvbC1Gfsl+1edudYF0w+
Yf+8q9Nn3myH8QP2n/YQX3q35Z09AxSoLDvjeLkRLm9f9i1i8646uH77swfU
7KZUw823z5K2UU+ogNtvX32Ob4tcKdx99kbrorQuFMLdb2/k9Ot8SR7cf/bf
Th18xZMN97/9x3UxB2akw8PH/k6Q7jSJFHj42UtF62/sSYCHrz2//53QrzHw
8Le3myR0IigSHj/2c9f+81oaCo8/+2/z2BTfBsLj157py/ZuLT94/Ntfr9t2
OtYLnj7s48+uU2h3g6cfezFFz5PLnODpy95ujRzzXjuY+6bYl0Rt4Dpl9c4e
AJEDWGE=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=40\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843202527075`*^9}]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1120, 780},
WindowMargins->{{152, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "S6.6.1"->{
  Cell[1665, 49, 96, 2, 32, "Input",
   CellTags->"S6.6.1"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"S6.6.1", 396172, 10260}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 279, 5, 48, "Input",
 InitializationCell->True],
Cell[827, 27, 282, 5, 48, "Input",
 InitializationCell->True],
Cell[1112, 34, 241, 5, 48, "Input",
 InitializationCell->True],
Cell[1356, 41, 306, 6, 48, "Input",
 InitializationCell->True],
Cell[1665, 49, 96, 2, 32, "Input",
 CellTags->"S6.6.1"],
Cell[1764, 53, 66, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[1855, 58, 123, 2, 32, "Input"],
Cell[1981, 62, 100, 1, 32, "Output"]
}, Open  ]],
Cell[2096, 66, 125, 3, 48, "Input",
 InitializationCell->True],
Cell[2224, 71, 115, 2, 48, "Input"],
Cell[2342, 75, 640, 19, 71, "Input"],
Cell[2985, 96, 5155, 134, 307, "Input",
 InitializationCell->True],
Cell[8143, 232, 361, 12, 54, "Input"],
Cell[8507, 246, 154, 3, 32, "Input"],
Cell[8664, 251, 178, 3, 48, "Input"],
Cell[8845, 256, 3795, 100, 255, "Input",
 InitializationCell->True],
Cell[12643, 358, 406, 13, 79, "Input"],
Cell[13052, 373, 4489, 128, 384, "Input",
 InitializationCell->True],
Cell[17544, 503, 487, 13, 48, "Input",
 InitializationCell->True],
Cell[18034, 518, 794, 23, 149, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[18853, 545, 730, 20, 54, "Input"],
Cell[19586, 567, 154, 4, 32, "Output"]
}, Open  ]],
Cell[19755, 574, 462, 7, 54, "Input"],
Cell[20220, 583, 83, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[20328, 589, 872, 20, 75, "Input"],
Cell[21203, 611, 160, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21400, 620, 778, 20, 93, "Input"],
Cell[22181, 642, 5135, 257, 186, 3021, 220, "GraphicsData", "PostScript", \
"Graphics"],
Cell[27319, 901, 134, 4, 32, "Output"]
}, Open  ]],
Cell[27468, 908, 907, 29, 67, "Input"],
Cell[28378, 939, 30, 0, 32, "Input"],
Cell[28411, 941, 1180, 36, 87, "Input"],
Cell[29594, 979, 567, 17, 63, "Input"],
Cell[30164, 998, 972, 28, 70, "Input",
 InitializationCell->True],
Cell[31139, 1028, 1023, 30, 92, "Input",
 InitializationCell->True],
Cell[32165, 1060, 26, 0, 32, "Input"],
Cell[CellGroupData[{
Cell[32216, 1064, 719, 18, 75, "Input"],
Cell[32938, 1084, 182, 3, 32, "Output"]
}, Open  ]],
Cell[33135, 1090, 1317, 39, 87, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[34477, 1133, 1032, 28, 96, "Input"],
Cell[35512, 1163, 5654, 107, 243, "Output"]
}, Open  ]],
Cell[41181, 1273, 110, 2, 48, "Input"],
Cell[41294, 1277, 1295, 40, 49, InheritFromParent],
Cell[42592, 1319, 109, 2, 48, "Input"],
Cell[42704, 1323, 3816, 120, 79, InheritFromParent],
Cell[46523, 1445, 99, 2, 48, "Input"],
Cell[46625, 1449, 1857, 57, 73, InheritFromParent],
Cell[48485, 1508, 103, 2, 48, "Input"],
Cell[48591, 1512, 1422, 47, 38, InheritFromParent],
Cell[50016, 1561, 118, 2, 48, "Input"],
Cell[50137, 1565, 4215, 137, 70, InheritFromParent],
Cell[54355, 1704, 113, 2, 48, "Input"],
Cell[54471, 1708, 1021, 34, 38, InheritFromParent],
Cell[55495, 1744, 1098, 35, 40, InheritFromParent],
Cell[56596, 1781, 101, 2, 48, "Input"],
Cell[56700, 1785, 2292, 73, 86, InheritFromParent],
Cell[58995, 1860, 4058, 129, 116, InheritFromParent],
Cell[63056, 1991, 1776, 61, 40, InheritFromParent],
Cell[64835, 2054, 114, 2, 48, "Input"],
Cell[64952, 2058, 2908, 66, 411, "Input"],
Cell[67863, 2126, 958, 29, 75, "Input"],
Cell[68824, 2157, 890, 26, 75, "Input"],
Cell[69717, 2185, 890, 26, 75, "Input"],
Cell[70610, 2213, 992, 30, 75, "Input"],
Cell[71605, 2245, 984, 29, 75, "Input"],
Cell[CellGroupData[{
Cell[72614, 2278, 1573, 37, 159, "Input"],
Cell[74190, 2317, 682, 16, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74909, 2338, 262, 7, 32, "Input"],
Cell[75174, 2347, 9249, 291, 249, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84460, 2643, 218, 5, 68, "Input"],
Cell[84681, 2650, 129, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84847, 2657, 71, 0, 32, "Input"],
Cell[84921, 2659, 141, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85099, 2666, 392, 8, 54, "Input"],
Cell[85494, 2676, 126, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85657, 2683, 140, 4, 35, "Input"],
Cell[85800, 2689, 127, 2, 32, "Output"]
}, Open  ]],
Cell[85942, 2694, 282, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[86249, 2705, 180, 6, 32, "Input"],
Cell[86432, 2713, 46, 0, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86515, 2718, 57, 1, 32, "Input"],
Cell[86575, 2721, 46, 0, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86658, 2726, 130, 4, 32, "Input"],
Cell[86791, 2732, 46, 0, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86874, 2737, 211, 7, 32, "Input"],
Cell[87088, 2746, 137, 3, 32, "Output"]
}, Open  ]],
Cell[87240, 2752, 396, 10, 48, "Input"],
Cell[87639, 2764, 1018, 35, 43, InheritFromParent],
Cell[88660, 2801, 1018, 35, 43, InheritFromParent],
Cell[89681, 2838, 1425, 46, 70, InheritFromParent],
Cell[91109, 2886, 1425, 46, 70, InheritFromParent],
Cell[92537, 2934, 1514, 50, 70, InheritFromParent],
Cell[94054, 2986, 165, 3, 48, "Input"],
Cell[94222, 2991, 369, 11, 48, "Input"],
Cell[94594, 3004, 336, 10, 48, "Input"],
Cell[94933, 3016, 1771, 52, 131, "Input"],
Cell[96707, 3070, 5354, 148, 471, "Input",
 InitializationCell->True],
Cell[102064, 3220, 167, 4, 48, "Input"],
Cell[102234, 3226, 4838, 130, 209, "Input"],
Cell[107075, 3358, 247, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[107347, 3369, 1091, 30, 49, "Input"],
Cell[108441, 3401, 252, 6, 68, "Output"]
}, Open  ]],
Cell[108708, 3410, 145, 2, 48, "Input"],
Cell[108856, 3414, 7117, 180, 374, "Input",
 InitializationCell->True],
Cell[115976, 3596, 2868, 75, 132, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[118869, 3675, 1615, 33, 159, "Input"],
Cell[120487, 3710, 46, 0, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120570, 3715, 1628, 33, 159, "Input"],
Cell[122201, 3750, 63, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122301, 3756, 1848, 52, 102, "Input"],
Cell[124152, 3810, 301, 6, 68, "Output"]
}, Open  ]],
Cell[124468, 3819, 7661, 200, 294, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[132154, 4023, 843, 26, 60, "Input"],
Cell[133000, 4051, 4265, 119, 92, "Output"]
}, Open  ]],
Cell[137280, 4173, 6222, 159, 253, "Input",
 InitializationCell->True],
Cell[143505, 4334, 1043, 29, 114, "Input"],
Cell[CellGroupData[{
Cell[144573, 4367, 1353, 41, 64, "Input"],
Cell[145929, 4410, 1084, 34, 58, "Output"]
}, Open  ]],
Cell[147028, 4447, 1644, 47, 110, "Input",
 InitializationCell->True],
Cell[148675, 4496, 3376, 96, 121, "Input",
 InitializationCell->True],
Cell[152054, 4594, 91, 1, 48, "Input"],
Cell[152148, 4597, 306, 7, 48, "Input"],
Cell[152457, 4606, 31548, 703, 1889, "Input",
 InitializationCell->True],
Cell[184008, 5311, 124, 3, 48, "Input",
 InitializationCell->True],
Cell[184135, 5316, 192, 3, 48, "Input"],
Cell[184330, 5321, 7101, 156, 561, "Input",
 InitializationCell->True],
Cell[191434, 5479, 998, 20, 112, "Input",
 InitializationCell->True],
Cell[192435, 5501, 2700, 62, 196, "Input",
 InitializationCell->True],
Cell[195138, 5565, 225, 6, 48, "Input"],
Cell[195366, 5573, 1353, 27, 112, "Input",
 InitializationCell->True],
Cell[196722, 5602, 206, 4, 48, "Input"],
Cell[196931, 5608, 417, 14, 34, "Input"],
Cell[197351, 5624, 1165, 26, 118, "Input",
 InitializationCell->True],
Cell[198519, 5652, 1208, 26, 118, "Input",
 InitializationCell->True],
Cell[199730, 5680, 99, 2, 48, "Input"],
Cell[199832, 5684, 1086, 29, 112, "Input",
 InitializationCell->True],
Cell[200921, 5715, 96, 2, 48, "Input"],
Cell[CellGroupData[{
Cell[201042, 5721, 2236, 44, 448, "Input",
 InitializationCell->True],
Cell[203281, 5767, 493, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203811, 5781, 2221, 43, 432, "Input"],
Cell[206035, 5826, 177, 4, 32, "Output"]
}, Open  ]],
Cell[206227, 5833, 65, 1, 48, "Input"],
Cell[CellGroupData[{
Cell[206317, 5838, 6074, 153, 369, "Input"],
Cell[CellGroupData[{
Cell[212416, 5995, 326, 6, 24, "Print"],
Cell[212745, 6003, 574, 12, 24, "Print"],
Cell[213322, 6017, 520, 11, 24, "Print"],
Cell[213845, 6030, 2120, 38, 82, "Print"]
}, Open  ]],
Cell[215980, 6071, 4901, 102, 151, "Output"]
}, Open  ]],
Cell[220896, 6176, 180, 3, 48, "Input"],
Cell[221079, 6181, 102, 3, 32, "Input"],
Cell[221184, 6186, 6149, 140, 505, "Input",
 InitializationCell->True],
Cell[227336, 6328, 1821, 41, 194, "Input",
 InitializationCell->True],
Cell[229160, 6371, 2205, 48, 175, "Input",
 InitializationCell->True],
Cell[231368, 6421, 2658, 56, 196, "Input",
 InitializationCell->True],
Cell[234029, 6479, 2205, 48, 175, "Input",
 InitializationCell->True],
Cell[236237, 6529, 2335, 51, 196, "Input",
 InitializationCell->True],
Cell[238575, 6582, 3386, 75, 287, "Input",
 InitializationCell->True],
Cell[241964, 6659, 3537, 68, 280, "Input",
 InitializationCell->True],
Cell[245504, 6729, 107, 3, 32, "Input"],
Cell[245614, 6734, 4026, 85, 366, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[249665, 6823, 2557, 49, 453, "Input"],
Cell[252225, 6874, 149, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252411, 6883, 6322, 156, 390, "Input"],
Cell[CellGroupData[{
Cell[258758, 7043, 331, 6, 24, "Print"],
Cell[259092, 7051, 577, 12, 24, "Print"],
Cell[259672, 7065, 1125, 22, 27, "Print"],
Cell[260800, 7089, 524, 11, 24, "Print"],
Cell[261327, 7102, 2120, 38, 82, "Print"]
}, Open  ]],
Cell[263462, 7143, 2442, 50, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265941, 7198, 6322, 156, 390, "Input"],
Cell[CellGroupData[{
Cell[272288, 7358, 277, 6, 24, "Print"],
Cell[272568, 7366, 525, 12, 24, "Print"],
Cell[273096, 7380, 1071, 22, 27, "Print"],
Cell[274170, 7404, 469, 11, 24, "Print"],
Cell[274642, 7417, 2068, 38, 82, "Print"]
}, Open  ]],
Cell[276725, 7458, 2410, 51, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279172, 7514, 77, 1, 32, "Input"],
Cell[279252, 7517, 582, 10, 24, "Message"],
Cell[279837, 7529, 572, 10, 24, "Message"],
Cell[280412, 7541, 413, 8, 24, "Message"],
Cell[280828, 7551, 359, 7, 24, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281224, 7563, 12176, 300, 768, "Input"],
Cell[CellGroupData[{
Cell[293425, 7867, 302, 6, 24, "Print"],
Cell[293730, 7875, 548, 12, 24, "Print"],
Cell[294281, 7889, 554, 12, 24, "Print"],
Cell[294838, 7903, 555, 12, 24, "Print"]
}, Open  ]],
Cell[295408, 7918, 6539, 129, 290, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301984, 8052, 7170, 152, 747, "Input"],
Cell[CellGroupData[{
Cell[309179, 8208, 275, 6, 24, "Print"],
Cell[309457, 8216, 521, 12, 24, "Print"],
Cell[309981, 8230, 2350, 51, 257, "Print"],
Cell[312334, 8283, 2232, 49, 252, "Print"],
Cell[314569, 8334, 330, 7, 24, "Print"],
Cell[314902, 8343, 292, 7, 24, "Print"],
Cell[315197, 8352, 292, 7, 24, "Print"],
Cell[315492, 8361, 542, 13, 27, "Print"]
}, Open  ]],
Cell[316049, 8377, 174, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316260, 8386, 4330, 96, 334, "Input"],
Cell[320593, 8484, 229, 5, 24, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320859, 8494, 12300, 297, 768, "Input"],
Cell[CellGroupData[{
Cell[333184, 8795, 229, 5, 24, "Print"],
Cell[333416, 8802, 475, 11, 24, "Print"],
Cell[333894, 8815, 482, 11, 24, "Print"],
Cell[334379, 8828, 482, 11, 24, "Print"]
}, Open  ]],
Cell[334876, 8842, 126, 3, 32, "Output"]
}, Open  ]],
Cell[335017, 8848, 21389, 511, 1246, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[356431, 9363, 108, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[356564, 9369, 253, 5, 24, "Print"],
Cell[356820, 9376, 499, 11, 24, "Print"],
Cell[357322, 9389, 506, 11, 24, "Print"],
Cell[357831, 9402, 504, 11, 24, "Print"]
}, Open  ]],
Cell[358350, 9416, 6275, 126, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364662, 9547, 108, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[364795, 9553, 253, 5, 24, "Print"],
Cell[365051, 9560, 499, 11, 24, "Print"],
Cell[365553, 9573, 508, 11, 24, "Print"],
Cell[366064, 9586, 504, 11, 24, "Print"]
}, Open  ]],
Cell[366583, 9600, 6254, 126, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[372874, 9731, 111, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[373010, 9737, 253, 5, 24, "Print"],
Cell[373266, 9744, 499, 11, 24, "Print"],
Cell[373768, 9757, 508, 11, 24, "Print"],
Cell[374279, 9770, 506, 11, 24, "Print"]
}, Open  ]],
Cell[374800, 9784, 6241, 125, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[381078, 9914, 109, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[381212, 9920, 253, 5, 24, "Print"],
Cell[381468, 9927, 499, 11, 24, "Print"],
Cell[381970, 9940, 506, 11, 24, "Print"],
Cell[382479, 9953, 504, 11, 24, "Print"]
}, Open  ]],
Cell[382998, 9967, 6223, 125, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389258, 10097, 109, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[389392, 10103, 231, 5, 24, "Print"],
Cell[389626, 10110, 477, 11, 24, "Print"],
Cell[390106, 10123, 487, 11, 24, "Print"],
Cell[390596, 10136, 481, 11, 24, "Print"]
}, Open  ]],
Cell[391092, 10150, 4629, 93, 259, "Output"]
}, Open  ]]
}
]
*)

